(()=>{var ot=(t,e)=>Array(Math.abs(e)+1).join(t);function g(t,e,n){return function(...r){return console.warn(`${t} is deprecated. Use ${e}.`),n.apply(this,r)}}function it(t){return t!==null&&typeof t=="object"&&typeof t.name=="string"}function st(t){return t!==null&&typeof t=="object"&&typeof t.step=="number"&&typeof t.alt=="number"}var pe=[0,2,4,-1,1,3,5],de=pe.map(t=>Math.floor(t*7/12));function he(t){let{step:e,alt:n,oct:r,dir:o=1}=t,i=pe[e]+7*n;if(r===void 0)return[o*i];let a=r-de[e]-4*n;return[o*i,o*a]}var Vr=[3,0,4,1,5,2,6];function ye(t){let[e,n,r]=t,o=Vr[$r(e)],i=Math.floor((e+1)/7);if(n===void 0)return{step:o,alt:i,dir:r};let a=n+4*i+de[o];return{step:o,alt:i,oct:a,dir:r}}function $r(t){let e=(t+1)%7;return e<0?7+e:e}var Pe={empty:!0,name:"",pc:"",acc:""},Me=new Map,Rr=t=>"CDEFGAB".charAt(t),at=t=>t<0?ot("b",-t):ot("#",t),ct=t=>t[0]==="b"?-t.length:t.length;function d(t){let e=Me.get(t);if(e)return e;let n=typeof t=="string"?kr(t):st(t)?d(Or(t)):it(t)?d(t.name):Pe;return Me.set(t,n),n}var Lr=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function Vt(t){let e=Lr.exec(t);return[e[1].toUpperCase(),e[2].replace(/x/g,"##"),e[3],e[4]]}function _e(t){return d(ye(t))}var qr=(t,e)=>(t%e+e)%e,$t=[0,2,4,5,7,9,11];function kr(t){let e=Vt(t);if(e[0]===""||e[3]!=="")return Pe;let n=e[0],r=e[1],o=e[2],i=(n.charCodeAt(0)+3)%7,a=ct(r),s=o.length?+o:void 0,c=he({step:i,alt:a,oct:s}),l=n+r+o,m=n+r,p=($t[i]+a+120)%12,f=s===void 0?qr($t[i]+a,12)-12*99:$t[i]+a+12*(s+1),u=f>=0&&f<=127?f:null,y=s===void 0?null:Math.pow(2,(f-69)/12)*440;return{empty:!1,acc:r,alt:a,chroma:p,coord:c,freq:y,height:f,letter:n,midi:u,name:l,oct:s,pc:m,step:i}}function Or(t){let{step:e,alt:n,oct:r}=t,o=Rr(e);if(!o)return"";let i=o+at(n);return r||r===0?i+r:i}var Rt={empty:!0,name:"",acc:""},Br="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",zr="(AA|A|P|M|m|d|dd)([-+]?\\d+)",Gr=new RegExp("^"+Br+"|"+zr+"$");function Ur(t){let e=Gr.exec(`${t}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var ge={};function w(t){return typeof t=="string"?ge[t]||(ge[t]=Hr(t)):st(t)?w(Kr(t)):it(t)?w(t.name):Rt}var xe=[0,2,4,5,7,9,11],ve="PMMPPMM";function Hr(t){let e=Ur(t);if(e[0]==="")return Rt;let n=+e[0],r=e[1],o=(Math.abs(n)-1)%7,i=ve[o];if(i==="M"&&r==="P")return Rt;let a=i==="M"?"majorable":"perfectable",s=""+n+r,c=n<0?-1:1,l=n===8||n===-8?n:c*(o+1),m=Xr(a,r),p=Math.floor((Math.abs(n)-1)/7),f=c*(xe[o]+m+12*p),u=(c*(xe[o]+m)%12+12)%12,y=he({step:o,alt:m,oct:p,dir:c});return{empty:!1,name:s,num:n,q:r,step:o,alt:m,dir:c,type:a,simple:l,semitones:f,chroma:u,coord:y,oct:p}}function kt(t){let[e,n=0]=t,r=e*7+n*12<0,o=r?[-e,-n,-1]:[e,n,1];return w(ye(o))}function Xr(t,e){return e==="M"&&t==="majorable"||e==="P"&&t==="perfectable"?0:e==="m"&&t==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(t==="perfectable"?e.length:e.length+1):0}function Kr(t){let{step:e,alt:n,oct:r=0,dir:o}=t;if(!o)return"";let i=e+1+7*r,a=o<0?"-":"",s=ve[e]==="M"?"majorable":"perfectable",c=a+i+Qr(s,n);return c}function Qr(t,e){return e===0?t==="majorable"?"M":"P":e===-1&&t==="majorable"?"m":e>0?ot("A",e):ot("d",t==="perfectable"?e:e+1)}function A(t,e){let n=d(t),r=w(e);if(n.empty||r.empty)return"";let o=n.coord,i=r.coord,a=o.length===1?[o[0]+i[0]]:[o[0]+i[0],o[1]+i[1]];return _e(a).name}function z(t,e){let n=d(t),r=d(e);if(n.empty||r.empty)return"";let o=n.coord,i=r.coord,a=i[0]-o[0],s=o.length===2&&i.length===2?i[1]-o[1]:-Math.floor(a*7/12);return kt([a,s]).name}function Wr(t,e){let n=[];for(;e--;n[e]=e+t);return n}function Zr(t,e){let n=[];for(;e--;n[e]=t-e);return n}function X(t,e){return t<e?Wr(t,e-t+1):Zr(t,t-e+1)}function R(t,e){let n=e.length,r=(t%n+n)%n;return e.slice(r,n).concat(e.slice(0,r))}function Ot(t){return t.filter(e=>e===0||e)}var C={empty:!0,name:"",setNum:0,chroma:"000000000000",normalized:"000000000000",intervals:[]},Lt=t=>Number(t).toString(2),Ae=t=>parseInt(t,2),Jr=/^[01]{12}$/;function be(t){return Jr.test(t)}var to=t=>typeof t=="number"&&t>=0&&t<=4095,eo=t=>t&&be(t.chroma),we={[C.chroma]:C};function x(t){let e=be(t)?t:to(t)?Lt(t):Array.isArray(t)?ro(t):eo(t)?t.chroma:C.chroma;return we[e]=we[e]||no(e)}var oo=g("Pcset.pcset","Pcset.get",x),io=t=>x(t).chroma,so=t=>x(t).intervals,ao=t=>x(t).setNum,co=["1P","2m","2M","3m","3M","4P","5d","5P","6m","6M","7m","7M"];function qt(t){let e=[];for(let n=0;n<12;n++)t.charAt(n)==="1"&&e.push(co[n]);return e}function lo(){return X(2048,4095).map(Lt)}function Q(t,e=!0){let n=x(t),r=n.chroma.split("");return Ot(r.map((o,i)=>{let a=R(i,r);return e&&a[0]==="0"?null:a.join("")}))}function mo(t,e){return x(t).setNum===x(e).setNum}function G(t){let e=x(t).setNum;return n=>{let r=x(n).setNum;return e&&e!==r&&(r&e)===r}}function U(t){let e=x(t).setNum;return n=>{let r=x(n).setNum;return e&&e!==r&&(r|e)===r}}function Se(t){let e=x(t);return n=>{let r=d(n);return e&&!r.empty&&e.chroma.charAt(r.chroma)==="1"}}function uo(t){let e=Se(t);return n=>n.filter(e)}var fo={get:x,chroma:io,num:ao,intervals:so,chromas:lo,isSupersetOf:U,isSubsetOf:G,isNoteIncludedIn:Se,isEqual:mo,filter:uo,modes:Q,pcset:oo};function po(t){let e=t.split("");return e.map((n,r)=>R(r,e).join(""))}function no(t){let e=Ae(t),n=po(t).map(Ae).filter(i=>i>=2048).sort()[0],r=Lt(n),o=qt(t);return{empty:!1,name:"",setNum:e,chroma:t,normalized:r,intervals:o}}function ro(t){if(t.length===0)return C.chroma;let e,n=[0,0,0,0,0,0,0,0,0,0,0,0];for(let r=0;r<t.length;r++)e=d(t[r]),e.empty&&(e=w(t[r])),e.empty||(n[e.chroma]=1);return n.join("")}var Bt=fo,ho=[["1P 3M 5P","major","M ^ "],["1P 3M 5P 7M","major seventh","maj7 \u0394 ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 \u03949 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth/ninth","6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 \u0394#4 \u0394#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -\u03947 m\u0394 -^7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim \xB0 o"],["1P 3m 5d 7d","diminished seventh","dim7 \xB07 o7"],["1P 3m 5d 7m","half-diminished","m7b5 \xF8 -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 \u03949#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],yo={...C,name:"",quality:"Unknown",intervals:[],aliases:[]},H=[],k={};function lt(t){return k[t]||yo}var Po=g("ChordType.chordType","ChordType.get",lt);function Mo(){return H.map(t=>t.name).filter(t=>t)}function _o(){return H.map(t=>t.aliases[0]).filter(t=>t)}function go(){return Object.keys(k)}function E(){return H.slice()}var xo=g("ChordType.entries","ChordType.all",E);function vo(){H=[],k={}}function Ne(t,e,n){let r=bo(t),o={...x(t),name:n||"",quality:r,intervals:t,aliases:e};H.push(o),o.name&&(k[o.name]=o),k[o.setNum]=o,k[o.chroma]=o,o.aliases.forEach(i=>Ao(o,i))}function Ao(t,e){k[e]=t}function bo(t){let e=n=>t.indexOf(n)!==-1;return e("5A")?"Augmented":e("3M")?"Major":e("5d")?"Diminished":e("3m")?"Minor":"Unknown"}ho.forEach(([t,e,n])=>Ne(t.split(" "),n.split(" "),e));H.sort((t,e)=>t.setNum-e.setNum);var wo={names:Mo,symbols:_o,get:lt,all:E,add:Ne,removeAll:vo,keys:go,entries:xo,chordType:Po},zt=wo,So=t=>{let e=t.reduce((n,r)=>{let o=d(r).chroma;return o!==void 0&&(n[o]=n[o]||d(r).name),n},{});return n=>e[n]};function Gt(t){let e=t.map(r=>d(r).pc).filter(r=>r);if(d.length===0)return[];let n=No(e,1);return n.filter(r=>r.weight).sort((r,o)=>o.weight-r.weight).map(r=>r.name)}function No(t,e){let n=t[0],r=d(n).chroma,o=So(t),i=Q(t,!1),a=[];return i.forEach((s,c)=>{let l=E().filter(m=>m.chroma===s);l.forEach(m=>{let p=m.aliases[0],f=o(c),u=c!==r;u?a.push({weight:.5*e,name:`${f}${p}/${n}`}):a.push({weight:1*e,name:`${f}${p}`})})}),a}var jo=[["1P 2M 3M 5P 6M","major pentatonic","pentatonic"],["1P 3M 4P 5P 7M","ionian pentatonic"],["1P 3M 4P 5P 7m","mixolydian pentatonic","indian"],["1P 2M 4P 5P 6M","ritusen"],["1P 2M 4P 5P 7m","egyptian"],["1P 3M 4P 5d 7m","neopolitan major pentatonic"],["1P 3m 4P 5P 6m","vietnamese 1"],["1P 2m 3m 5P 6m","pelog"],["1P 2m 4P 5P 6m","kumoijoshi"],["1P 2M 3m 5P 6m","hirajoshi"],["1P 2m 4P 5d 7m","iwato"],["1P 2m 4P 5P 7m","in-sen"],["1P 3M 4A 5P 7M","lydian pentatonic","chinese"],["1P 3m 4P 6m 7m","malkos raga"],["1P 3m 4P 5d 7m","locrian pentatonic","minor seven flat five pentatonic"],["1P 3m 4P 5P 7m","minor pentatonic","vietnamese 2"],["1P 3m 4P 5P 6M","minor six pentatonic"],["1P 2M 3m 5P 6M","flat three pentatonic","kumoi"],["1P 2M 3M 5P 6m","flat six pentatonic"],["1P 2m 3M 5P 6M","scriabin"],["1P 3M 5d 6m 7m","whole tone pentatonic"],["1P 3M 4A 5A 7M","lydian #5P pentatonic"],["1P 3M 4A 5P 7m","lydian dominant pentatonic"],["1P 3m 4P 5P 7M","minor #7M pentatonic"],["1P 3m 4d 5d 7m","super locrian pentatonic"],["1P 2M 3m 4P 5P 7M","minor hexatonic"],["1P 2A 3M 5P 5A 7M","augmented"],["1P 2M 3m 3M 5P 6M","major blues"],["1P 2M 4P 5P 6M 7m","piongio"],["1P 2m 3M 4A 6M 7m","prometheus neopolitan"],["1P 2M 3M 4A 6M 7m","prometheus"],["1P 2m 3M 5d 6m 7m","mystery #1"],["1P 2m 3M 4P 5A 6M","six tone symmetric"],["1P 2M 3M 4A 5A 7m","whole tone","messiaen's mode #1"],["1P 2m 4P 4A 5P 7M","messiaen's mode #5"],["1P 3m 4P 5d 5P 7m","minor blues","blues"],["1P 2M 3M 4P 5d 6m 7m","locrian major","arabian"],["1P 2m 3M 4A 5P 6m 7M","double harmonic lydian"],["1P 2M 3m 4P 5P 6m 7M","harmonic minor"],["1P 2m 3m 4d 5d 6m 7m","altered","super locrian","diminished whole tone","pomeroy"],["1P 2M 3m 4P 5d 6m 7m","locrian #2","half-diminished","aeolian b5"],["1P 2M 3M 4P 5P 6m 7m","mixolydian b6","melodic minor fifth mode","hindu"],["1P 2M 3M 4A 5P 6M 7m","lydian dominant","lydian b7","overtone"],["1P 2M 3M 4A 5P 6M 7M","lydian"],["1P 2M 3M 4A 5A 6M 7M","lydian augmented"],["1P 2m 3m 4P 5P 6M 7m","dorian b2","phrygian #6","melodic minor second mode"],["1P 2M 3m 4P 5P 6M 7M","melodic minor"],["1P 2m 3m 4P 5d 6m 7m","locrian"],["1P 2m 3m 4d 5d 6m 7d","ultralocrian","superlocrian bb7","\xB7superlocrian diminished"],["1P 2m 3m 4P 5d 6M 7m","locrian 6","locrian natural 6","locrian sharp 6"],["1P 2A 3M 4P 5P 5A 7M","augmented heptatonic"],["1P 2M 3m 5d 5P 6M 7m","romanian minor"],["1P 2M 3m 4A 5P 6M 7m","dorian #4"],["1P 2M 3m 4A 5P 6M 7M","lydian diminished"],["1P 2m 3m 4P 5P 6m 7m","phrygian"],["1P 2M 3M 4A 5A 7m 7M","leading whole tone"],["1P 2M 3M 4A 5P 6m 7m","lydian minor"],["1P 2m 3M 4P 5P 6m 7m","phrygian dominant","spanish","phrygian major"],["1P 2m 3m 4P 5P 6m 7M","balinese"],["1P 2m 3m 4P 5P 6M 7M","neopolitan major"],["1P 2M 3m 4P 5P 6m 7m","aeolian","minor"],["1P 2M 3M 4P 5P 6m 7M","harmonic major"],["1P 2m 3M 4P 5P 6m 7M","double harmonic major","gypsy"],["1P 2M 3m 4P 5P 6M 7m","dorian"],["1P 2M 3m 4A 5P 6m 7M","hungarian minor"],["1P 2A 3M 4A 5P 6M 7m","hungarian major"],["1P 2m 3M 4P 5d 6M 7m","oriental"],["1P 2m 3m 3M 4A 5P 7m","flamenco"],["1P 2m 3m 4A 5P 6m 7M","todi raga"],["1P 2M 3M 4P 5P 6M 7m","mixolydian","dominant"],["1P 2m 3M 4P 5d 6m 7M","persian"],["1P 2M 3M 4P 5P 6M 7M","major","ionian"],["1P 2m 3M 5d 6m 7m 7M","enigmatic"],["1P 2M 3M 4P 5A 6M 7M","major augmented","major #5","ionian augmented","ionian #5"],["1P 2A 3M 4A 5P 6M 7M","lydian #9"],["1P 2m 2M 4P 4A 5P 6m 7M","messiaen's mode #4"],["1P 2m 3M 4P 4A 5P 6m 7M","purvi raga"],["1P 2m 3m 3M 4P 5P 6m 7m","spanish heptatonic"],["1P 2M 3M 4P 5P 6M 7m 7M","bebop"],["1P 2M 3m 3M 4P 5P 6M 7m","bebop minor"],["1P 2M 3M 4P 5P 5A 6M 7M","bebop major"],["1P 2m 3m 4P 5d 5P 6m 7m","bebop locrian"],["1P 2M 3m 4P 5P 6m 7m 7M","minor bebop"],["1P 2M 3m 4P 5d 6m 6M 7M","diminished","whole-half diminished"],["1P 2M 3M 4P 5d 5P 6M 7M","ichikosucho"],["1P 2M 3m 4P 5P 6m 6M 7M","minor six diminished"],["1P 2m 3m 3M 4A 5P 6M 7m","half-whole diminished","dominant diminished","messiaen's mode #2"],["1P 3m 3M 4P 5P 6M 7m 7M","kafi raga"],["1P 2M 3M 4P 4A 5A 6A 7M","messiaen's mode #6"],["1P 2M 3m 3M 4P 5d 5P 6M 7m","composite blues"],["1P 2M 3m 3M 4A 5P 6m 7m 7M","messiaen's mode #3"],["1P 2m 2M 3m 4P 4A 5P 6m 6M 7M","messiaen's mode #7"],["1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M","chromatic"]],Io={...C,intervals:[],aliases:[]},mt=[],O={};function Ut(){return mt.map(t=>t.name)}function ut(t){return O[t]||Io}var Co=g("ScaleDictionary.scaleType","ScaleType.get",ut);function L(){return mt.slice()}var Eo=g("ScaleDictionary.entries","ScaleType.all",L);function To(){return Object.keys(O)}function Do(){mt=[],O={}}function je(t,e,n=[]){let r={...x(t),name:e,intervals:t,aliases:n};return mt.push(r),O[r.name]=r,O[r.setNum]=r,O[r.chroma]=r,r.aliases.forEach(o=>Fo(r,o)),r}function Fo(t,e){O[e]=t}jo.forEach(([t,e,...n])=>je(t.split(" "),e,n));var Vo={names:Ut,get:ut,all:L,add:je,removeAll:Do,keys:To,entries:Eo,scaleType:Co},Ht=Vo,Kt={empty:!0,name:"",symbol:"",root:"",rootDegree:0,type:"",tonic:null,setNum:NaN,quality:"Unknown",chroma:"",normalized:"",aliases:[],notes:[],intervals:[]},$o=/^(6|64|7|9|11|13)$/;function ft(t){let[e,n,r,o]=Vt(t);return e===""?["",t]:e==="A"&&o==="ug"?["","aug"]:!o&&(r==="4"||r==="5")?[e+n,r]:$o.test(r)?[e+n,r+o]:[e+n+r,o]}function Y(t){if(t==="")return Kt;if(Array.isArray(t)&&t.length===2)return pt(t[1],t[0]);{let[e,n]=ft(t),r=pt(n,e);return r.empty?pt(t):r}}function pt(t,e,n){let r=lt(t),o=d(e||""),i=d(n||"");if(r.empty||e&&o.empty||n&&i.empty)return Kt;let a=z(o.pc,i.pc),s=r.intervals.indexOf(a)+1;if(!i.empty&&!s)return Kt;let c=Array.from(r.intervals);for(let f=1;f<s;f++){let u=c[0][0],y=c[0][1],j=parseInt(u,10)+7;c.push(`${j}${y}`),c.shift()}let l=o.empty?[]:c.map(f=>A(o,f));t=r.aliases.indexOf(t)!==-1?t:r.aliases[0];let m=`${o.empty?"":o.pc}${t}${i.empty||s<=1?"":"/"+i.pc}`,p=`${e?o.pc+" ":""}${r.name}${s>1&&n?" over "+i.pc:""}`;return{...r,name:p,symbol:m,type:r.name,root:i.name,intervals:c,rootDegree:s,tonic:o.name,notes:l}}var Ro=g("Chord.chord","Chord.get",Y);function ko(t,e){let[n,r]=ft(t);return n?A(n,e)+r:t}function Oo(t){let e=Y(t),n=U(e.chroma);return L().filter(r=>n(r.chroma)).map(r=>r.name)}function Lo(t){let e=Y(t),n=U(e.chroma);return E().filter(r=>n(r.chroma)).map(r=>e.tonic+r.aliases[0])}function qo(t){let e=Y(t),n=G(e.chroma);return E().filter(r=>n(r.chroma)).map(r=>e.tonic+r.aliases[0])}var Bo={getChord:pt,get:Y,detect:Gt,chordScales:Oo,extended:Lo,reduced:qo,tokenize:ft,transpose:ko,chord:Ro},dt=Bo;var zo=[[.125,"dl",["large","duplex longa","maxima","octuple","octuple whole"]],[.25,"l",["long","longa"]],[.5,"d",["double whole","double","breve"]],[1,"w",["whole","semibreve"]],[2,"h",["half","minim"]],[4,"q",["quarter","crotchet"]],[8,"e",["eighth","quaver"]],[16,"s",["sixteenth","semiquaver"]],[32,"t",["thirty-second","demisemiquaver"]],[64,"sf",["sixty-fourth","hemidemisemiquaver"]],[128,"h",["hundred twenty-eighth"]],[256,"th",["two hundred fifty-sixth"]]],Go=[];zo.forEach(([t,e,n])=>Uo(t,e,n));function Uo(t,e,n){Go.push({empty:!1,dots:"",name:"",value:1/t,fraction:t<1?[1/t,1]:[1,t],shorthand:e,names:n})}var wa=w,Sa="P m M m M P d P m M m M".split(" "),Na=z,ja=Ie((t,e)=>[t[0]+e[0],t[1]+e[1]]),Ia=Ie((t,e)=>[t[0]-e[0],t[1]-e[1]]);function Ie(t){return(e,n)=>{let r=w(e).coord,o=w(n).coord;if(r&&o){let i=t(r,o);return kt(i).name}}}var Ta=Math.log(2),Da=Math.log(440),Fa="C C# D D# E F F# G G# A A# B".split(" "),Va="C Db D Eb E F Gb G Ab A Bb B".split(" "),Ko=t=>t.name,Xo=t=>t.map(d).filter(e=>!e.empty),La=d,qa=A,Ba=A,Ce=(t,e)=>t.height-e.height;function Qo(t,e){return e=e||Ce,Xo(t).sort(e).map(Ko)}function Ee(t){return Qo(t,Ce).filter((e,n,r)=>n===0||e!==r[n-1])}var Te={empty:!0,name:"",chordType:""},De={};function q(t){return typeof t=="string"?De[t]||(De[t]=Wo(t)):typeof t=="number"?q(Xt[t]||""):st(t)?Yo(t):it(t)?q(t.name):Te}var Ua=g("RomanNumeral.romanNumeral","RomanNumeral.get",q);function Yo(t){return q(at(t.alt)+Xt[t.step])}var Zo=/^(#{1,}|b{1,}|x{1,}|)(IV|I{1,3}|VI{0,2}|iv|i{1,3}|vi{0,2})([^IViv]*)$/;function Jo(t){return Zo.exec(t)||["","","",""]}var Fe="I II III IV V VI VII",Xt=Fe.split(" "),Ha=Fe.toLowerCase().split(" ");function Wo(t){let[e,n,r,o]=Jo(t);if(!r)return Te;let i=r.toUpperCase(),a=Xt.indexOf(i),s=ct(n),c=1;return{empty:!1,name:e,roman:r,interval:w({step:a,alt:s,dir:c}).name,acc:n,chordType:o,alt:s,step:a,major:r===i,oct:0,dir:c}}var N=Object.freeze([]),Ve={type:"major",tonic:"",alteration:0,keySignature:""},ht={tonic:"",grades:N,intervals:N,scale:N,chords:N,chordsHarmonicFunction:N,chordScales:N},Za={...Ve,...ht,type:"major",minorRelative:"",scale:N,secondaryDominants:N,secondaryDominantsMinorRelative:N,substituteDominants:N,substituteDominantsMinorRelative:N},Ja={...Ve,type:"minor",relativeMajor:"",natural:ht,harmonic:ht,melodic:ht},$e=(t,e,n="")=>e.map((r,o)=>`${t[o]}${n}${r}`);function yt(t,e,n,r){return o=>{let i=t.map(s=>q(s).interval||""),a=i.map(s=>A(o,s));return{tonic:o,grades:t,intervals:i,scale:a,chords:$e(a,e),chordsHarmonicFunction:n.slice(),chordScales:$e(a,r," ")}}}var tc=yt("I II III IV V VI VII".split(" "),"maj7 m7 m7 maj7 7 m7 m7b5".split(" "),"T SD T SD D T D".split(" "),"major,dorian,phrygian,lydian,mixolydian,minor,locrian".split(",")),ec=yt("I II bIII IV V bVI bVII".split(" "),"m7 m7b5 maj7 m7 m7 maj7 7".split(" "),"T SD T SD D SD SD".split(" "),"minor,locrian,major,dorian,phrygian,lydian,mixolydian".split(",")),nc=yt("I II bIII IV V bVI VII".split(" "),"mMaj7 m7b5 +maj7 m7 7 maj7 o7".split(" "),"T SD T SD D SD D".split(" "),"harmonic minor,locrian 6,major augmented,lydian diminished,phrygian dominant,lydian #9,ultralocrian".split(",")),rc=yt("I II bIII IV V VI VII".split(" "),"m6 m7 +maj7 7 7 m7b5 m7b5".split(" "),"T SD T SD D  ".split(" "),"melodic minor,dorian b2,lydian augmented,lydian dominant,mixolydian b6,locrian #2,altered".split(","));var Qt=[[0,2773,0,"ionian","","Maj7","major"],[1,2902,2,"dorian","m","m7"],[2,3418,4,"phrygian","m","m7"],[3,2741,-1,"lydian","","Maj7"],[4,2774,1,"mixolydian","","7"],[5,2906,3,"aeolian","m","m7","minor"],[6,3434,5,"locrian","dim","m7b5"]],Re={...C,name:"",alt:0,modeNum:NaN,triad:"",seventh:"",aliases:[]},ke=Qt.map(ti),Yt={};ke.forEach(t=>{Yt[t.name]=t,t.aliases.forEach(e=>{Yt[e]=t})});function Wt(t){return typeof t=="string"?Yt[t.toLowerCase()]||Re:t&&t.name?Wt(t.name):Re}var uc=g("Mode.mode","Mode.get",Wt);function ei(){return ke.slice()}var fc=g("Mode.mode","Mode.all",ei);function ti(t){let[e,n,r,o,i,a,s]=t,c=s?[s]:[],l=Number(n).toString(2),m=qt(l);return{empty:!1,intervals:m,modeNum:e,chroma:l,normalized:l,name:o,setNum:n,alt:r,triad:i,seventh:a,aliases:c}}function Oe(t){return(e,n)=>{let r=Wt(e);if(r.empty)return[];let o=R(r.modeNum,t),i=r.intervals.map(a=>A(n,a));return o.map((a,s)=>i[s]+a)}}var pc=Oe(Qt.map(t=>t[4])),dc=Oe(Qt.map(t=>t[5]));var ni={empty:!0,name:"",type:"",tonic:null,setNum:NaN,chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function Le(t){if(typeof t!="string")return["",""];let e=t.indexOf(" "),n=d(t.substring(0,e));if(n.empty){let o=d(t);return o.empty?["",t]:[o.name,""]}let r=t.substring(n.name.length+1);return[n.name,r.length?r:""]}var ri=Ut;function D(t){let e=Array.isArray(t)?t:Le(t),n=d(e[0]).name,r=ut(e[1]);if(r.empty)return ni;let o=r.name,i=n?r.intervals.map(s=>A(n,s)):[],a=n?n+" "+o:o;return{...r,name:a,type:o,tonic:n,notes:i}}var oi=g("Scale.scale","Scale.get",D);function ii(t){let e=D(t),n=G(e.chroma);return E().filter(r=>n(r.chroma)).map(r=>r.aliases[0])}function si(t){let e=D(t),n=U(e.chroma);return L().filter(r=>n(r.chroma)).map(r=>r.name)}function ai(t){let e=G(D(t).chroma);return L().filter(n=>e(n.chroma)).map(n=>n.name)}function qe(t){let e=t.map(o=>d(o).pc).filter(o=>o),n=e[0],r=Ee(e);return R(r.indexOf(n),r)}function ci(t){let e=D(t);if(e.empty)return[];let n=e.tonic?e.notes:e.intervals;return Q(e.chroma).map((r,o)=>{let i=D(r).name;return i?[n[o],i]:["",""]}).filter(r=>r[0])}function li(t){let e=Array.isArray(t)?qe(t):D(t).notes,n=e.map(r=>d(r).chroma);return r=>{let o=typeof r=="number"?r:d(r).height;if(o===void 0)return;let i=o%12,a=Math.floor(o/12)-1,s=n.indexOf(i);return s===-1?void 0:e[s]+a}}function mi(t){let e=li(t);return(n,r)=>{let o=d(n).height,i=d(r).height;return o===void 0||i===void 0?[]:X(o,i).map(e).filter(a=>a)}}var ui={get:D,names:ri,extended:si,modeNames:ci,reduced:ai,scaleChords:ii,scaleNotes:qe,tokenize:Le,rangeOf:mi,scale:oi},Zt=ui;var Ec=new Map;var fl=Bt,pl=zt,dl=Ht,Pt="http://www.w3.org/1999/xhtml",Jt={svg:"http://www.w3.org/2000/svg",xhtml:Pt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Mt(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Jt.hasOwnProperty(e)?{space:Jt[e],local:t}:t}function fi(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Pt&&e.documentElement.namespaceURI===Pt?e.createElement(t):e.createElementNS(n,t)}}function pi(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function _t(t){var e=Mt(t);return(e.local?pi:fi)(e)}function di(){}function gt(t){return t==null?di:function(){return this.querySelector(t)}}function Be(t){typeof t!="function"&&(t=gt(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i=e[o],a=i.length,s=r[o]=new Array(a),c,l,m=0;m<a;++m)(c=i[m])&&(l=t.call(c,c.__data__,m,i))&&("__data__"in c&&(l.__data__=c.__data__),s[m]=l);return new P(r,this._parents)}function hi(){return[]}function ze(t){return t==null?hi:function(){return this.querySelectorAll(t)}}function Ge(t){typeof t!="function"&&(t=ze(t));for(var e=this._groups,n=e.length,r=[],o=[],i=0;i<n;++i)for(var a=e[i],s=a.length,c,l=0;l<s;++l)(c=a[l])&&(r.push(t.call(c,c.__data__,l,a)),o.push(c));return new P(r,o)}function Ue(t){return function(){return this.matches(t)}}function He(t){typeof t!="function"&&(t=Ue(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i=e[o],a=i.length,s=r[o]=[],c,l=0;l<a;++l)(c=i[l])&&t.call(c,c.__data__,l,i)&&s.push(c);return new P(r,this._parents)}function xt(t){return new Array(t.length)}function Ke(){return new P(this._enter||this._groups.map(xt),this._parents)}function W(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}W.prototype={constructor:W,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Xe(t){return function(){return t}}var Qe="$";function yi(t,e,n,r,o,i){for(var a=0,s,c=e.length,l=i.length;a<l;++a)(s=e[a])?(s.__data__=i[a],r[a]=s):n[a]=new W(t,i[a]);for(;a<c;++a)(s=e[a])&&(o[a]=s)}function Pi(t,e,n,r,o,i,a){var s,c,l={},m=e.length,p=i.length,f=new Array(m),u;for(s=0;s<m;++s)(c=e[s])&&(f[s]=u=Qe+a.call(c,c.__data__,s,e),u in l?o[s]=c:l[u]=c);for(s=0;s<p;++s)u=Qe+a.call(t,i[s],s,i),(c=l[u])?(r[s]=c,c.__data__=i[s],l[u]=null):n[s]=new W(t,i[s]);for(s=0;s<m;++s)(c=e[s])&&l[f[s]]===c&&(o[s]=c)}function Ye(t,e){if(!t)return u=new Array(this.size()),l=-1,this.each(function(Dt){u[++l]=Dt}),u;var n=e?Pi:yi,r=this._parents,o=this._groups;typeof t!="function"&&(t=Xe(t));for(var i=o.length,a=new Array(i),s=new Array(i),c=new Array(i),l=0;l<i;++l){var m=r[l],p=o[l],f=p.length,u=t.call(m,m&&m.__data__,l,r),y=u.length,j=s[l]=new Array(y),T=a[l]=new Array(y),B=c[l]=new Array(f);n(m,p,j,T,B,u,e);for(var v=0,S=0,F,V;v<y;++v)if(F=j[v]){for(v>=S&&(S=v+1);!(V=T[S])&&++S<y;);F._next=V||null}}return a=new P(a,r),a._enter=s,a._exit=c,a}function We(){return new P(this._exit||this._groups.map(xt),this._parents)}function Ze(t,e,n){var r=this.enter(),o=this,i=this.exit();return r=typeof t=="function"?t(r):r.append(t+""),e!=null&&(o=e(o)),n==null?i.remove():n(i),r&&o?r.merge(o).order():o}function Je(t){for(var e=this._groups,n=t._groups,r=e.length,o=n.length,i=Math.min(r,o),a=new Array(r),s=0;s<i;++s)for(var c=e[s],l=n[s],m=c.length,p=a[s]=new Array(m),f,u=0;u<m;++u)(f=c[u]||l[u])&&(p[u]=f);for(;s<r;++s)a[s]=e[s];return new P(a,this._parents)}function tn(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],o=r.length-1,i=r[o],a;--o>=0;)(a=r[o])&&(i&&a.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(a,i),i=a);return this}function en(t){t||(t=Mi);function e(p,f){return p&&f?t(p.__data__,f.__data__):!p-!f}for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var a=n[i],s=a.length,c=o[i]=new Array(s),l,m=0;m<s;++m)(l=a[m])&&(c[m]=l);c.sort(e)}return new P(o,this._parents).order()}function Mi(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function nn(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function rn(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t}function on(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],o=0,i=r.length;o<i;++o){var a=r[o];if(a)return a}return null}function sn(){var t=0;return this.each(function(){++t}),t}function an(){return!this.node()}function cn(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var o=e[n],i=0,a=o.length,s;i<a;++i)(s=o[i])&&t.call(s,s.__data__,i,o);return this}function _i(t){return function(){this.removeAttribute(t)}}function gi(t){return function(){this.removeAttributeNS(t.space,t.local)}}function xi(t,e){return function(){this.setAttribute(t,e)}}function vi(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Ai(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function bi(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function ln(t,e){var n=Mt(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?gi:_i:typeof e=="function"?n.local?bi:Ai:n.local?vi:xi)(n,e))}function vt(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function wi(t){return function(){this.style.removeProperty(t)}}function Si(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Ni(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function mn(t,e,n){return arguments.length>1?this.each((e==null?wi:typeof e=="function"?Ni:Si)(t,e,n??"")):ji(this.node(),t)}function ji(t,e){return t.style.getPropertyValue(e)||vt(t).getComputedStyle(t,null).getPropertyValue(e)}function Ii(t){return function(){delete this[t]}}function Ci(t,e){return function(){this[t]=e}}function Ei(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function un(t,e){return arguments.length>1?this.each((e==null?Ii:typeof e=="function"?Ei:Ci)(t,e)):this.node()[t]}function fn(t){return t.trim().split(/^|\s+/)}function te(t){return t.classList||new pn(t)}function pn(t){this._node=t,this._names=fn(t.getAttribute("class")||"")}pn.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function dn(t,e){for(var n=te(t),r=-1,o=e.length;++r<o;)n.add(e[r])}function hn(t,e){for(var n=te(t),r=-1,o=e.length;++r<o;)n.remove(e[r])}function Ti(t){return function(){dn(this,t)}}function Di(t){return function(){hn(this,t)}}function Fi(t,e){return function(){(e.apply(this,arguments)?dn:hn)(this,t)}}function yn(t,e){var n=fn(t+"");if(arguments.length<2){for(var r=te(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof e=="function"?Fi:e?Ti:Di)(n,e))}function Vi(){this.textContent=""}function $i(t){return function(){this.textContent=t}}function Ri(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Pn(t){return arguments.length?this.each(t==null?Vi:(typeof t=="function"?Ri:$i)(t)):this.node().textContent}function ki(){this.innerHTML=""}function Oi(t){return function(){this.innerHTML=t}}function Li(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Mn(t){return arguments.length?this.each(t==null?ki:(typeof t=="function"?Li:Oi)(t)):this.node().innerHTML}function qi(){this.nextSibling&&this.parentNode.appendChild(this)}function _n(){return this.each(qi)}function Bi(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function gn(){return this.each(Bi)}function xn(t){var e=typeof t=="function"?t:_t(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function zi(){return null}function vn(t,e){var n=typeof t=="function"?t:_t(t),r=e==null?zi:typeof e=="function"?e:gt(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Gi(){var t=this.parentNode;t&&t.removeChild(this)}function An(){return this.each(Gi)}function Ui(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Hi(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function bn(t){return this.select(t?Hi:Ui)}function wn(t){return arguments.length?this.property("__data__",t):this.node().__data__}var Sn={},ee=null;typeof document!="undefined"&&(Nn=document.documentElement,"onmouseenter"in Nn||(Sn={mouseenter:"mouseover",mouseleave:"mouseout"}));var Nn;function Ki(t,e,n){return t=jn(t,e,n),function(r){var o=r.relatedTarget;(!o||o!==this&&!(o.compareDocumentPosition(this)&8))&&t.call(this,r)}}function jn(t,e,n){return function(r){var o=ee;ee=r;try{t.call(this,this.__data__,e,n)}finally{ee=o}}}function Xi(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Qi(t){return function(){var e=this.__on;if(!e)return;for(var n=0,r=-1,o=e.length,i;n<o;++n)(i=e[n],(!t.type||i.type===t.type)&&i.name===t.name)?this.removeEventListener(i.type,i.listener,i.capture):e[++r]=i;++r?e.length=r:delete this.__on}}function Yi(t,e,n){var r=Sn.hasOwnProperty(t.type)?Ki:jn;return function(o,i,a){var s=this.__on,c,l=r(e,i,a);if(s){for(var m=0,p=s.length;m<p;++m)if((c=s[m]).type===t.type&&c.name===t.name){this.removeEventListener(c.type,c.listener,c.capture),this.addEventListener(c.type,c.listener=l,c.capture=n),c.value=e;return}}this.addEventListener(t.type,l,n),c={type:t.type,name:t.name,value:e,listener:l,capture:n},s?s.push(c):this.__on=[c]}}function In(t,e,n){var r=Xi(t+""),o,i=r.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var c=0,l=s.length,m;c<l;++c)for(o=0,m=s[c];o<i;++o)if((a=r[o]).type===m.type&&a.name===m.name)return m.value}return}for(s=e?Yi:Qi,n==null&&(n=!1),o=0;o<i;++o)this.each(s(r[o],e,n));return this}function Cn(t,e,n){var r=vt(t),o=r.CustomEvent;typeof o=="function"?o=new o(e,n):(o=r.document.createEvent("Event"),n?(o.initEvent(e,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(e,!1,!1)),t.dispatchEvent(o)}function Wi(t,e){return function(){return Cn(this,t,e)}}function Zi(t,e){return function(){return Cn(this,t,e.apply(this,arguments))}}function En(t,e){return this.each((typeof e=="function"?Zi:Wi)(t,e))}var ne=[null];function P(t,e){this._groups=t,this._parents=e}function Ji(){return new P([[document.documentElement]],ne)}P.prototype=Ji.prototype={constructor:P,select:Be,selectAll:Ge,filter:He,data:Ye,enter:Ke,exit:We,join:Ze,merge:Je,order:tn,sort:en,call:nn,nodes:rn,node:on,size:sn,empty:an,each:cn,attr:ln,style:mn,property:un,classed:yn,text:Pn,html:Mn,raise:_n,lower:gn,append:xn,insert:vn,remove:An,clone:bn,datum:wn,on:In,dispatch:En};function Tn(t){return typeof t=="string"?new P([[document.querySelector(t)]],[document.documentElement]):new P([[t]],ne)}var At=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],Dn={A:"G##","A#":"Bb",Ab:"G#",B:"Cb","B#":"C",Bb:"A#",C:"B#","C#":"Db",D:"C##","D#":"Eb",Db:"C#","E#":"F",Eb:"D#",F:"E#","F#":"Gb",G:"F##","G#":"Ab",Gb:"F#"},_=["#fb8072","#fccde5","#fdb462","#ffed6f","#ffffb3","#b3de69","#ccebc5","#80b1d3","#bc80bd","#8dd3c7","#bebada","#d9d9d9"];function Fn(t,e,n=[]){let r=(t+e)%At.length,o=At[r];if(n&&!n.includes(o)){let i=Dn[o];if(n.includes(i))o=i;else return}return o}function re(t){switch(t.length){case 3:return[_[0],_[4],_[7]];case 4:return[_[0],_[4],_[7],_[11]];case 5:return[_[0],_[4],_[7],_[11],_[2]];case 7:return[_[0],_[2],_[4],_[5],_[7],_[9],_[11]];default:return _.slice(0,t.length)}}function Vn(t){return t.endsWith("b")?At.indexOf(Dn[t]):At.indexOf(t)}function $n(t){return t.replace(/b/g,"\u266D").replace(/#/g,"\u266F")}function oe(t,e,n,r,o="#cccccc",i=null,a=null,s=null){let c=t.append("svg:circle").attr("cx",e).attr("cy",n).attr("r",r).style("fill",o);i&&c.style("stroke",i),a&&c.style("stroke-width",a),s&&c.attr("title",s)}function ie(t,e,n){let r=e.tuning,o=e.string_gauges,i=e.fret_count,a=Tn(t);a.selectAll("*").remove();let s=a.node().parentElement.getBoundingClientRect(),c=s.width*.95,l=40,m=140,p=l*(i+1),f=m*(i+1);c=Math.min(f,Math.max(p,c));let u=c/(i+1),y=u*.65,j=y*.1,T=u*.01,B=u*.8,v=y*.5,S=y*r.length+v,F=c-B*1.2,V=[3,5,7,9,12,15,17,19,21,24],Dt=y*(r.length-1),Ir=u*.06,tt=u*.22,Cr=tt*.2,et=tt*1.05,nt=tt*.3;a.attr("width",c).attr("height",S);let rt=`translate(${B}, ${v})`,Er=a.append("g").attr("class","frets").attr("transform",rt),le=a.append("g").attr("class","fret-markers").attr("transform",rt),Tr=a.append("g").attr("class","strings").attr("transform",rt),me=a.append("g").attr("class","notes").attr("transform",rt);for(let M=0;M<=i;M++){let I=M*u,b=Ir;M==0&&(b*=1.5),Er.append("svg:line").attr("x1",I).attr("y1",-j/2).attr("x2",I).attr("y2",Dt+j).style("stroke","#222222").style("stroke-width",b).append("title").text(M)}for(let M of V){if(M>i)break;let I=M*u-u/2,b=S-v-nt*3;if(M%12==0){let $=nt*1.3;oe(le,I+$,b,nt),I-=$}oe(le,I,b,nt)}for(let M=0;M<r.length;M++){let I=r[M],b=M*y;Tr.append("svg:line").attr("x1",-T/2).attr("y1",b).attr("x2",F+T).attr("y2",b).style("stroke","#444444").style("stroke-width",o[M]*y).append("title").text(I)}for(let M=0;M<r.length;M++){let I=Vn(r[M]);for(let b=0;b<=i;b++){let $=Fn(I,b,n);if(!$)continue;let Ft=b*u-u*.5,ue=M*y,fe=Ft-et*.34,Dr=ue+et*.34;$.length>1&&(fe=Ft-et*.5),oe(me,Ft,ue,tt,"#ffffff","#aaaaaa",Cr,$),me.append("svg:text").attr("x",fe).attr("y",Dr).attr("fill","#000000").style("font-size",`${et}px`).text($n($))}}}var se={guitar:{tuning:["E","B","G","D","A","E"],string_gauges:[.01,.013,.017,.026,.036,.046],fret_count:15},ukulele:{tuning:["A","E","C","G"],string_gauges:[.024,.031,.037,.026],fret_count:12}};var bt="http://www.w3.org/1999/xhtml",ae={svg:"http://www.w3.org/2000/svg",xhtml:bt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function wt(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),ae.hasOwnProperty(e)?{space:ae[e],local:t}:t}function ts(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===bt&&e.documentElement.namespaceURI===bt?e.createElement(t):e.createElementNS(n,t)}}function es(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function St(t){var e=wt(t);return(e.local?es:ts)(e)}function ns(){}function Nt(t){return t==null?ns:function(){return this.querySelector(t)}}function Rn(t){typeof t!="function"&&(t=Nt(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i=e[o],a=i.length,s=r[o]=new Array(a),c,l,m=0;m<a;++m)(c=i[m])&&(l=t.call(c,c.__data__,m,i))&&("__data__"in c&&(l.__data__=c.__data__),s[m]=l);return new h(r,this._parents)}function K(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function rs(){return[]}function kn(t){return t==null?rs:function(){return this.querySelectorAll(t)}}function os(t){return function(){var e=t.apply(this,arguments);return e==null?[]:K(e)}}function On(t){typeof t=="function"?t=os(t):t=kn(t);for(var e=this._groups,n=e.length,r=[],o=[],i=0;i<n;++i)for(var a=e[i],s=a.length,c,l=0;l<s;++l)(c=a[l])&&(r.push(t.call(c,c.__data__,l,a)),o.push(c));return new h(r,o)}function Ln(t){return function(){return this.matches(t)}}function jt(t){return function(e){return e.matches(t)}}var is=Array.prototype.find;function ss(t){return function(){return is.call(this.children,t)}}function as(){return this.firstElementChild}function qn(t){return this.select(t==null?as:ss(typeof t=="function"?t:jt(t)))}var cs=Array.prototype.filter;function ls(){return this.children}function ms(t){return function(){return cs.call(this.children,t)}}function Bn(t){return this.selectAll(t==null?ls:ms(typeof t=="function"?t:jt(t)))}function zn(t){typeof t!="function"&&(t=Ln(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i=e[o],a=i.length,s=r[o]=[],c,l=0;l<a;++l)(c=i[l])&&t.call(c,c.__data__,l,i)&&s.push(c);return new h(r,this._parents)}function It(t){return new Array(t.length)}function Gn(){return new h(this._enter||this._groups.map(It),this._parents)}function Z(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Z.prototype={constructor:Z,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Un(t){return function(){return t}}function us(t,e,n,r,o,i){for(var a=0,s,c=e.length,l=i.length;a<l;++a)(s=e[a])?(s.__data__=i[a],r[a]=s):n[a]=new Z(t,i[a]);for(;a<c;++a)(s=e[a])&&(o[a]=s)}function fs(t,e,n,r,o,i,a){var s,c,l=new Map,m=e.length,p=i.length,f=new Array(m),u;for(s=0;s<m;++s)(c=e[s])&&(f[s]=u=a.call(c,c.__data__,s,e)+"",l.has(u)?o[s]=c:l.set(u,c));for(s=0;s<p;++s)u=a.call(t,i[s],s,i)+"",(c=l.get(u))?(r[s]=c,c.__data__=i[s],l.delete(u)):n[s]=new Z(t,i[s]);for(s=0;s<m;++s)(c=e[s])&&l.get(f[s])===c&&(o[s]=c)}function ps(t){return t.__data__}function Hn(t,e){if(!arguments.length)return Array.from(this,ps);var n=e?fs:us,r=this._parents,o=this._groups;typeof t!="function"&&(t=Un(t));for(var i=o.length,a=new Array(i),s=new Array(i),c=new Array(i),l=0;l<i;++l){var m=r[l],p=o[l],f=p.length,u=K(t.call(m,m&&m.__data__,l,r)),y=u.length,j=s[l]=new Array(y),T=a[l]=new Array(y),B=c[l]=new Array(f);n(m,p,j,T,B,u,e);for(var v=0,S=0,F,V;v<y;++v)if(F=j[v]){for(v>=S&&(S=v+1);!(V=T[S])&&++S<y;);F._next=V||null}}return a=new h(a,r),a._enter=s,a._exit=c,a}function Kn(){return new h(this._exit||this._groups.map(It),this._parents)}function Xn(t,e,n){var r=this.enter(),o=this,i=this.exit();return r=typeof t=="function"?t(r):r.append(t+""),e!=null&&(o=e(o)),n==null?i.remove():n(i),r&&o?r.merge(o).order():o}function Qn(t){if(!(t instanceof h))throw new Error("invalid merge");for(var e=this._groups,n=t._groups,r=e.length,o=n.length,i=Math.min(r,o),a=new Array(r),s=0;s<i;++s)for(var c=e[s],l=n[s],m=c.length,p=a[s]=new Array(m),f,u=0;u<m;++u)(f=c[u]||l[u])&&(p[u]=f);for(;s<r;++s)a[s]=e[s];return new h(a,this._parents)}function Yn(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],o=r.length-1,i=r[o],a;--o>=0;)(a=r[o])&&(i&&a.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(a,i),i=a);return this}function Wn(t){t||(t=ds);function e(p,f){return p&&f?t(p.__data__,f.__data__):!p-!f}for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var a=n[i],s=a.length,c=o[i]=new Array(s),l,m=0;m<s;++m)(l=a[m])&&(c[m]=l);c.sort(e)}return new h(o,this._parents).order()}function ds(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Zn(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Jn(){return Array.from(this)}function tr(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],o=0,i=r.length;o<i;++o){var a=r[o];if(a)return a}return null}function er(){let t=0;for(let e of this)++t;return t}function nr(){return!this.node()}function rr(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var o=e[n],i=0,a=o.length,s;i<a;++i)(s=o[i])&&t.call(s,s.__data__,i,o);return this}function hs(t){return function(){this.removeAttribute(t)}}function ys(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ps(t,e){return function(){this.setAttribute(t,e)}}function Ms(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function _s(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function gs(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function or(t,e){var n=wt(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?ys:hs:typeof e=="function"?n.local?gs:_s:n.local?Ms:Ps)(n,e))}function Ct(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function xs(t){return function(){this.style.removeProperty(t)}}function vs(t,e,n){return function(){this.style.setProperty(t,e,n)}}function As(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function ir(t,e,n){return arguments.length>1?this.each((e==null?xs:typeof e=="function"?As:vs)(t,e,n??"")):bs(this.node(),t)}function bs(t,e){return t.style.getPropertyValue(e)||Ct(t).getComputedStyle(t,null).getPropertyValue(e)}function ws(t){return function(){delete this[t]}}function Ss(t,e){return function(){this[t]=e}}function Ns(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function sr(t,e){return arguments.length>1?this.each((e==null?ws:typeof e=="function"?Ns:Ss)(t,e)):this.node()[t]}function ar(t){return t.trim().split(/^|\s+/)}function ce(t){return t.classList||new cr(t)}function cr(t){this._node=t,this._names=ar(t.getAttribute("class")||"")}cr.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function lr(t,e){for(var n=ce(t),r=-1,o=e.length;++r<o;)n.add(e[r])}function mr(t,e){for(var n=ce(t),r=-1,o=e.length;++r<o;)n.remove(e[r])}function js(t){return function(){lr(this,t)}}function Is(t){return function(){mr(this,t)}}function Cs(t,e){return function(){(e.apply(this,arguments)?lr:mr)(this,t)}}function ur(t,e){var n=ar(t+"");if(arguments.length<2){for(var r=ce(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof e=="function"?Cs:e?js:Is)(n,e))}function Es(){this.textContent=""}function Ts(t){return function(){this.textContent=t}}function Ds(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function fr(t){return arguments.length?this.each(t==null?Es:(typeof t=="function"?Ds:Ts)(t)):this.node().textContent}function Fs(){this.innerHTML=""}function Vs(t){return function(){this.innerHTML=t}}function $s(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function pr(t){return arguments.length?this.each(t==null?Fs:(typeof t=="function"?$s:Vs)(t)):this.node().innerHTML}function Rs(){this.nextSibling&&this.parentNode.appendChild(this)}function dr(){return this.each(Rs)}function ks(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function hr(){return this.each(ks)}function yr(t){var e=typeof t=="function"?t:St(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Os(){return null}function Pr(t,e){var n=typeof t=="function"?t:St(t),r=e==null?Os:typeof e=="function"?e:Nt(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Ls(){var t=this.parentNode;t&&t.removeChild(this)}function Mr(){return this.each(Ls)}function qs(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Bs(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function _r(t){return this.select(t?Bs:qs)}function gr(t){return arguments.length?this.property("__data__",t):this.node().__data__}function zs(t){return function(e){t.call(this,e,this.__data__)}}function Gs(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Us(t){return function(){var e=this.__on;if(!e)return;for(var n=0,r=-1,o=e.length,i;n<o;++n)(i=e[n],(!t.type||i.type===t.type)&&i.name===t.name)?this.removeEventListener(i.type,i.listener,i.options):e[++r]=i;++r?e.length=r:delete this.__on}}function Hs(t,e,n){return function(){var r=this.__on,o,i=zs(e);if(r){for(var a=0,s=r.length;a<s;++a)if((o=r[a]).type===t.type&&o.name===t.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=n),o.value=e;return}}this.addEventListener(t.type,i,n),o={type:t.type,name:t.name,value:e,listener:i,options:n},r?r.push(o):this.__on=[o]}}function xr(t,e,n){var r=Gs(t+""),o,i=r.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var c=0,l=s.length,m;c<l;++c)for(o=0,m=s[c];o<i;++o)if((a=r[o]).type===m.type&&a.name===m.name)return m.value}return}for(s=e?Hs:Us,o=0;o<i;++o)this.each(s(r[o],e,n));return this}function vr(t,e,n){var r=Ct(t),o=r.CustomEvent;typeof o=="function"?o=new o(e,n):(o=r.document.createEvent("Event"),n?(o.initEvent(e,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(e,!1,!1)),t.dispatchEvent(o)}function Ks(t,e){return function(){return vr(this,t,e)}}function Xs(t,e){return function(){return vr(this,t,e.apply(this,arguments))}}function Ar(t,e){return this.each((typeof e=="function"?Xs:Ks)(t,e))}function*br(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],o=0,i=r.length,a;o<i;++o)(a=r[o])&&(yield a)}var J=[null];function h(t,e){this._groups=t,this._parents=e}function Qs(){return new h([[document.documentElement]],J)}function Ys(){return this}h.prototype=Qs.prototype={constructor:h,select:Rn,selectAll:On,selectChild:qn,selectChildren:Bn,filter:zn,data:Hn,enter:Gn,exit:Kn,join:Xn,merge:Qn,selection:Ys,order:Yn,sort:Wn,call:Zn,nodes:Jn,node:tr,size:er,empty:nr,each:rr,attr:or,style:ir,property:sr,classed:ur,text:fr,html:pr,raise:dr,lower:hr,append:yr,insert:Pr,remove:Mr,clone:_r,datum:gr,on:xr,dispatch:Ar,[Symbol.iterator]:br};function Et(t){return typeof t=="string"?new h([[document.querySelector(t)]],[document.documentElement]):new h([[t]],J)}function wr(t){return typeof t=="string"?new h([document.querySelectorAll(t)],[document.documentElement]):new h([t==null?[]:K(t)],J)}var Tt=Et("#detected-chords"),Sr=Et("#chord-notes");function Nr(t){let e=re(t);ie("#fretboard",se.ukulele,t);for(let n in t)wr(`#fretboard .notes circle[title="${t[n]}"]`).style("fill",e[n])}function jr(t){Tt.selectAll("*").remove();let e=dt.detect(t.split(/[,\s]+/));if(e.length){let n=e.map(r=>{let o=dt.get(r.split("/")[0]);return{name:r,notes:o.notes}});Tt.append("h4").text("Detected"),Tt.append("ul").selectAll("li").data(n).join("li").text(r=>`${r.name}: ${r.notes.join(", ")}`),Nr(n[0].notes)}else Tt.append("h4").text("No chords detected"),Nr(Zt.get("A chromatic").notes)}Et("#chord-detect").on("click",()=>jr(Sr.property("value")));var Ws=Sr.on("change",t=>jr(t.target.value));Ws.attr("value","C E G").dispatch("change");})();
