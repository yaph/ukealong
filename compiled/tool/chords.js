(()=>{var tt=(t,e)=>Array(Math.abs(e)+1).join(t);function g(t,e,n){return function(...r){return console.warn(`${t} is deprecated. Use ${e}.`),n.apply(this,r)}}function et(t){return t!==null&&typeof t=="object"&&typeof t.name=="string"}function nt(t){return t!==null&&typeof t=="object"&&typeof t.step=="number"&&typeof t.alt=="number"}var le=[0,2,4,-1,1,3,5],me=le.map(t=>Math.floor(t*7/12));function ue(t){let{step:e,alt:n,oct:r,dir:o=1}=t,i=le[e]+7*n;if(r===void 0)return[o*i];let a=r-me[e]-4*n;return[o*i,o*a]}var br=[3,0,4,1,5,2,6];function fe(t){let[e,n,r]=t,o=br[wr(e)],i=Math.floor((e+1)/7);if(n===void 0)return{step:o,alt:i,dir:r};let a=n+4*i+me[o];return{step:o,alt:i,oct:a,dir:r}}function wr(t){let e=(t+1)%7;return e<0?7+e:e}var pe={empty:!0,name:"",pc:"",acc:""},de=new Map,Sr=t=>"CDEFGAB".charAt(t),rt=t=>t<0?tt("b",-t):tt("#",t),ot=t=>t[0]==="b"?-t.length:t.length;function d(t){let e=de.get(t);if(e)return e;let n=typeof t=="string"?Nr(t):nt(t)?d(jr(t)):et(t)?d(t.name):pe;return de.set(t,n),n}var Ir=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function Et(t){let e=Ir.exec(t);return[e[1].toUpperCase(),e[2].replace(/x/g,"##"),e[3],e[4]]}function he(t){return d(fe(t))}var Cr=(t,e)=>(t%e+e)%e,Tt=[0,2,4,5,7,9,11];function Nr(t){let e=Et(t);if(e[0]===""||e[3]!=="")return pe;let n=e[0],r=e[1],o=e[2],i=(n.charCodeAt(0)+3)%7,a=ot(r),s=o.length?+o:void 0,c=ue({step:i,alt:a,oct:s}),l=n+r+o,m=n+r,p=(Tt[i]+a+120)%12,f=s===void 0?Cr(Tt[i]+a,12)-12*99:Tt[i]+a+12*(s+1),u=f>=0&&f<=127?f:null,y=s===void 0?null:Math.pow(2,(f-69)/12)*440;return{empty:!1,acc:r,alt:a,chroma:p,coord:c,freq:y,height:f,letter:n,midi:u,name:l,oct:s,pc:m,step:i}}function jr(t){let{step:e,alt:n,oct:r}=t,o=Sr(e);if(!o)return"";let i=o+rt(n);return r||r===0?i+r:i}var Dt={empty:!0,name:"",acc:""},Er="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",Tr="(AA|A|P|M|m|d|dd)([-+]?\\d+)",Dr=new RegExp("^"+Er+"|"+Tr+"$");function Fr(t){let e=Dr.exec(`${t}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var ye={};function w(t){return typeof t=="string"?ye[t]||(ye[t]=Vr(t)):nt(t)?w(Rr(t)):et(t)?w(t.name):Dt}var Pe=[0,2,4,5,7,9,11],Me="PMMPPMM";function Vr(t){let e=Fr(t);if(e[0]==="")return Dt;let n=+e[0],r=e[1],o=(Math.abs(n)-1)%7,i=Me[o];if(i==="M"&&r==="P")return Dt;let a=i==="M"?"majorable":"perfectable",s=""+n+r,c=n<0?-1:1,l=n===8||n===-8?n:c*(o+1),m=$r(a,r),p=Math.floor((Math.abs(n)-1)/7),f=c*(Pe[o]+m+12*p),u=(c*(Pe[o]+m)%12+12)%12,y=ue({step:o,alt:m,oct:p,dir:c});return{empty:!1,name:s,num:n,q:r,step:o,alt:m,dir:c,type:a,simple:l,semitones:f,chroma:u,coord:y,oct:p}}function Ft(t){let[e,n=0]=t,r=e*7+n*12<0,o=r?[-e,-n,-1]:[e,n,1];return w(fe(o))}function $r(t,e){return e==="M"&&t==="majorable"||e==="P"&&t==="perfectable"?0:e==="m"&&t==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(t==="perfectable"?e.length:e.length+1):0}function Rr(t){let{step:e,alt:n,oct:r=0,dir:o}=t;if(!o)return"";let i=e+1+7*r,a=o<0?"-":"",s=Me[e]==="M"?"majorable":"perfectable",c=a+i+kr(s,n);return c}function kr(t,e){return e===0?t==="majorable"?"M":"P":e===-1&&t==="majorable"?"m":e>0?tt("A",e):tt("d",t==="perfectable"?e:e+1)}function A(t,e){let n=d(t),r=w(e);if(n.empty||r.empty)return"";let o=n.coord,i=r.coord,a=o.length===1?[o[0]+i[0]]:[o[0]+i[0],o[1]+i[1]];return he(a).name}function L(t,e){let n=d(t),r=d(e);if(n.empty||r.empty)return"";let o=n.coord,i=r.coord,a=i[0]-o[0],s=o.length===2&&i.length===2?i[1]-o[1]:-Math.floor(a*7/12);return Ft([a,s]).name}function Lr(t,e){let n=[];for(;e--;n[e]=e+t);return n}function qr(t,e){let n=[];for(;e--;n[e]=t-e);return n}function it(t,e){return t<e?Lr(t,e-t+1):qr(t,t-e+1)}function q(t,e){let n=e.length,r=(t%n+n)%n;return e.slice(r,n).concat(e.slice(0,r))}function Vt(t){return t.filter(e=>e===0||e)}var C={empty:!0,name:"",setNum:0,chroma:"000000000000",normalized:"000000000000",intervals:[]},Rt=t=>Number(t).toString(2),_e=t=>parseInt(t,2),Br=/^[01]{12}$/;function ge(t){return Br.test(t)}var zr=t=>typeof t=="number"&&t>=0&&t<=4095,Gr=t=>t&&ge(t.chroma),xe={[C.chroma]:C};function x(t){let e=ge(t)?t:zr(t)?Rt(t):Array.isArray(t)?Hr(t):Gr(t)?t.chroma:C.chroma;return xe[e]=xe[e]||Ur(e)}var Kr=g("Pcset.pcset","Pcset.get",x),Xr=t=>x(t).chroma,Qr=t=>x(t).intervals,Yr=t=>x(t).setNum,Wr=["1P","2m","2M","3m","3M","4P","5d","5P","6m","6M","7m","7M"];function $t(t){let e=[];for(let n=0;n<12;n++)t.charAt(n)==="1"&&e.push(Wr[n]);return e}function Zr(){return it(2048,4095).map(Rt)}function st(t,e=!0){let n=x(t),r=n.chroma.split("");return Vt(r.map((o,i)=>{let a=q(i,r);return e&&a[0]==="0"?null:a.join("")}))}function Jr(t,e){return x(t).setNum===x(e).setNum}function at(t){let e=x(t).setNum;return n=>{let r=x(n).setNum;return e&&e!==r&&(r&e)===r}}function G(t){let e=x(t).setNum;return n=>{let r=x(n).setNum;return e&&e!==r&&(r|e)===r}}function ve(t){let e=x(t);return n=>{let r=d(n);return e&&!r.empty&&e.chroma.charAt(r.chroma)==="1"}}function to(t){let e=ve(t);return n=>n.filter(e)}var eo={get:x,chroma:Xr,num:Yr,intervals:Qr,chromas:Zr,isSupersetOf:G,isSubsetOf:at,isNoteIncludedIn:ve,isEqual:Jr,filter:to,modes:st,pcset:Kr};function no(t){let e=t.split("");return e.map((n,r)=>q(r,e).join(""))}function Ur(t){let e=_e(t),n=no(t).map(_e).filter(i=>i>=2048).sort()[0],r=Rt(n),o=$t(t);return{empty:!1,name:"",setNum:e,chroma:t,normalized:r,intervals:o}}function Hr(t){if(t.length===0)return C.chroma;let e,n=[0,0,0,0,0,0,0,0,0,0,0,0];for(let r=0;r<t.length;r++)e=d(t[r]),e.empty&&(e=w(t[r])),e.empty||(n[e.chroma]=1);return n.join("")}var kt=eo,ro=[["1P 3M 5P","major","M ^ "],["1P 3M 5P 7M","major seventh","maj7 \u0394 ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 \u03949 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth/ninth","6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 \u0394#4 \u0394#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -\u03947 m\u0394 -^7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim \xB0 o"],["1P 3m 5d 7d","diminished seventh","dim7 \xB07 o7"],["1P 3m 5d 7m","half-diminished","m7b5 \xF8 -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 \u03949#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],oo={...C,name:"",quality:"Unknown",intervals:[],aliases:[]},B=[],R={};function ct(t){return R[t]||oo}var io=g("ChordType.chordType","ChordType.get",ct);function so(){return B.map(t=>t.name).filter(t=>t)}function ao(){return B.map(t=>t.aliases[0]).filter(t=>t)}function co(){return Object.keys(R)}function T(){return B.slice()}var lo=g("ChordType.entries","ChordType.all",T);function mo(){B=[],R={}}function Ae(t,e,n){let r=fo(t),o={...x(t),name:n||"",quality:r,intervals:t,aliases:e};B.push(o),o.name&&(R[o.name]=o),R[o.setNum]=o,R[o.chroma]=o,o.aliases.forEach(i=>uo(o,i))}function uo(t,e){R[e]=t}function fo(t){let e=n=>t.indexOf(n)!==-1;return e("5A")?"Augmented":e("3M")?"Major":e("5d")?"Diminished":e("3m")?"Minor":"Unknown"}ro.forEach(([t,e,n])=>Ae(t.split(" "),n.split(" "),e));B.sort((t,e)=>t.setNum-e.setNum);var po={names:so,symbols:ao,get:ct,all:T,add:Ae,removeAll:mo,keys:co,entries:lo,chordType:io},Ot=po,ho=t=>{let e=t.reduce((n,r)=>{let o=d(r).chroma;return o!==void 0&&(n[o]=n[o]||d(r).name),n},{});return n=>e[n]};function Lt(t){let e=t.map(r=>d(r).pc).filter(r=>r);if(d.length===0)return[];let n=yo(e,1);return n.filter(r=>r.weight).sort((r,o)=>o.weight-r.weight).map(r=>r.name)}function yo(t,e){let n=t[0],r=d(n).chroma,o=ho(t),i=st(t,!1),a=[];return i.forEach((s,c)=>{let l=T().filter(m=>m.chroma===s);l.forEach(m=>{let p=m.aliases[0],f=o(c),u=c!==r;u?a.push({weight:.5*e,name:`${f}${p}/${n}`}):a.push({weight:1*e,name:`${f}${p}`})})}),a}var Po=[["1P 2M 3M 5P 6M","major pentatonic","pentatonic"],["1P 3M 4P 5P 7M","ionian pentatonic"],["1P 3M 4P 5P 7m","mixolydian pentatonic","indian"],["1P 2M 4P 5P 6M","ritusen"],["1P 2M 4P 5P 7m","egyptian"],["1P 3M 4P 5d 7m","neopolitan major pentatonic"],["1P 3m 4P 5P 6m","vietnamese 1"],["1P 2m 3m 5P 6m","pelog"],["1P 2m 4P 5P 6m","kumoijoshi"],["1P 2M 3m 5P 6m","hirajoshi"],["1P 2m 4P 5d 7m","iwato"],["1P 2m 4P 5P 7m","in-sen"],["1P 3M 4A 5P 7M","lydian pentatonic","chinese"],["1P 3m 4P 6m 7m","malkos raga"],["1P 3m 4P 5d 7m","locrian pentatonic","minor seven flat five pentatonic"],["1P 3m 4P 5P 7m","minor pentatonic","vietnamese 2"],["1P 3m 4P 5P 6M","minor six pentatonic"],["1P 2M 3m 5P 6M","flat three pentatonic","kumoi"],["1P 2M 3M 5P 6m","flat six pentatonic"],["1P 2m 3M 5P 6M","scriabin"],["1P 3M 5d 6m 7m","whole tone pentatonic"],["1P 3M 4A 5A 7M","lydian #5P pentatonic"],["1P 3M 4A 5P 7m","lydian dominant pentatonic"],["1P 3m 4P 5P 7M","minor #7M pentatonic"],["1P 3m 4d 5d 7m","super locrian pentatonic"],["1P 2M 3m 4P 5P 7M","minor hexatonic"],["1P 2A 3M 5P 5A 7M","augmented"],["1P 2M 3m 3M 5P 6M","major blues"],["1P 2M 4P 5P 6M 7m","piongio"],["1P 2m 3M 4A 6M 7m","prometheus neopolitan"],["1P 2M 3M 4A 6M 7m","prometheus"],["1P 2m 3M 5d 6m 7m","mystery #1"],["1P 2m 3M 4P 5A 6M","six tone symmetric"],["1P 2M 3M 4A 5A 7m","whole tone","messiaen's mode #1"],["1P 2m 4P 4A 5P 7M","messiaen's mode #5"],["1P 3m 4P 5d 5P 7m","minor blues","blues"],["1P 2M 3M 4P 5d 6m 7m","locrian major","arabian"],["1P 2m 3M 4A 5P 6m 7M","double harmonic lydian"],["1P 2M 3m 4P 5P 6m 7M","harmonic minor"],["1P 2m 3m 4d 5d 6m 7m","altered","super locrian","diminished whole tone","pomeroy"],["1P 2M 3m 4P 5d 6m 7m","locrian #2","half-diminished","aeolian b5"],["1P 2M 3M 4P 5P 6m 7m","mixolydian b6","melodic minor fifth mode","hindu"],["1P 2M 3M 4A 5P 6M 7m","lydian dominant","lydian b7","overtone"],["1P 2M 3M 4A 5P 6M 7M","lydian"],["1P 2M 3M 4A 5A 6M 7M","lydian augmented"],["1P 2m 3m 4P 5P 6M 7m","dorian b2","phrygian #6","melodic minor second mode"],["1P 2M 3m 4P 5P 6M 7M","melodic minor"],["1P 2m 3m 4P 5d 6m 7m","locrian"],["1P 2m 3m 4d 5d 6m 7d","ultralocrian","superlocrian bb7","\xB7superlocrian diminished"],["1P 2m 3m 4P 5d 6M 7m","locrian 6","locrian natural 6","locrian sharp 6"],["1P 2A 3M 4P 5P 5A 7M","augmented heptatonic"],["1P 2M 3m 5d 5P 6M 7m","romanian minor"],["1P 2M 3m 4A 5P 6M 7m","dorian #4"],["1P 2M 3m 4A 5P 6M 7M","lydian diminished"],["1P 2m 3m 4P 5P 6m 7m","phrygian"],["1P 2M 3M 4A 5A 7m 7M","leading whole tone"],["1P 2M 3M 4A 5P 6m 7m","lydian minor"],["1P 2m 3M 4P 5P 6m 7m","phrygian dominant","spanish","phrygian major"],["1P 2m 3m 4P 5P 6m 7M","balinese"],["1P 2m 3m 4P 5P 6M 7M","neopolitan major"],["1P 2M 3m 4P 5P 6m 7m","aeolian","minor"],["1P 2M 3M 4P 5P 6m 7M","harmonic major"],["1P 2m 3M 4P 5P 6m 7M","double harmonic major","gypsy"],["1P 2M 3m 4P 5P 6M 7m","dorian"],["1P 2M 3m 4A 5P 6m 7M","hungarian minor"],["1P 2A 3M 4A 5P 6M 7m","hungarian major"],["1P 2m 3M 4P 5d 6M 7m","oriental"],["1P 2m 3m 3M 4A 5P 7m","flamenco"],["1P 2m 3m 4A 5P 6m 7M","todi raga"],["1P 2M 3M 4P 5P 6M 7m","mixolydian","dominant"],["1P 2m 3M 4P 5d 6m 7M","persian"],["1P 2M 3M 4P 5P 6M 7M","major","ionian"],["1P 2m 3M 5d 6m 7m 7M","enigmatic"],["1P 2M 3M 4P 5A 6M 7M","major augmented","major #5","ionian augmented","ionian #5"],["1P 2A 3M 4A 5P 6M 7M","lydian #9"],["1P 2m 2M 4P 4A 5P 6m 7M","messiaen's mode #4"],["1P 2m 3M 4P 4A 5P 6m 7M","purvi raga"],["1P 2m 3m 3M 4P 5P 6m 7m","spanish heptatonic"],["1P 2M 3M 4P 5P 6M 7m 7M","bebop"],["1P 2M 3m 3M 4P 5P 6M 7m","bebop minor"],["1P 2M 3M 4P 5P 5A 6M 7M","bebop major"],["1P 2m 3m 4P 5d 5P 6m 7m","bebop locrian"],["1P 2M 3m 4P 5P 6m 7m 7M","minor bebop"],["1P 2M 3m 4P 5d 6m 6M 7M","diminished","whole-half diminished"],["1P 2M 3M 4P 5d 5P 6M 7M","ichikosucho"],["1P 2M 3m 4P 5P 6m 6M 7M","minor six diminished"],["1P 2m 3m 3M 4A 5P 6M 7m","half-whole diminished","dominant diminished","messiaen's mode #2"],["1P 3m 3M 4P 5P 6M 7m 7M","kafi raga"],["1P 2M 3M 4P 4A 5A 6A 7M","messiaen's mode #6"],["1P 2M 3m 3M 4P 5d 5P 6M 7m","composite blues"],["1P 2M 3m 3M 4A 5P 6m 7m 7M","messiaen's mode #3"],["1P 2m 2M 3m 4P 4A 5P 6m 6M 7M","messiaen's mode #7"],["1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M","chromatic"]],Mo={...C,intervals:[],aliases:[]},lt=[],$={};function qt(){return lt.map(t=>t.name)}function mt(t){return $[t]||Mo}var _o=g("ScaleDictionary.scaleType","ScaleType.get",mt);function U(){return lt.slice()}var go=g("ScaleDictionary.entries","ScaleType.all",U);function xo(){return Object.keys($)}function vo(){lt=[],$={}}function be(t,e,n=[]){let r={...x(t),name:e,intervals:t,aliases:n};return lt.push(r),$[r.name]=r,$[r.setNum]=r,$[r.chroma]=r,r.aliases.forEach(o=>Ao(r,o)),r}function Ao(t,e){$[e]=t}Po.forEach(([t,e,...n])=>be(t.split(" "),e,n));var bo={names:qt,get:mt,all:U,add:be,removeAll:vo,keys:xo,entries:go,scaleType:_o},Bt=bo,zt={empty:!0,name:"",symbol:"",root:"",rootDegree:0,type:"",tonic:null,setNum:NaN,quality:"Unknown",chroma:"",normalized:"",aliases:[],notes:[],intervals:[]},wo=/^(6|64|7|9|11|13)$/;function ut(t){let[e,n,r,o]=Et(t);return e===""?["",t]:e==="A"&&o==="ug"?["","aug"]:!o&&(r==="4"||r==="5")?[e+n,r]:wo.test(r)?[e+n,r+o]:[e+n+r,o]}function H(t){if(t==="")return zt;if(Array.isArray(t)&&t.length===2)return ft(t[1],t[0]);{let[e,n]=ut(t),r=ft(n,e);return r.empty?ft(t):r}}function ft(t,e,n){let r=ct(t),o=d(e||""),i=d(n||"");if(r.empty||e&&o.empty||n&&i.empty)return zt;let a=L(o.pc,i.pc),s=r.intervals.indexOf(a)+1;if(!i.empty&&!s)return zt;let c=Array.from(r.intervals);for(let f=1;f<s;f++){let u=c[0][0],y=c[0][1],j=parseInt(u,10)+7;c.push(`${j}${y}`),c.shift()}let l=o.empty?[]:c.map(f=>A(o,f));t=r.aliases.indexOf(t)!==-1?t:r.aliases[0];let m=`${o.empty?"":o.pc}${t}${i.empty||s<=1?"":"/"+i.pc}`,p=`${e?o.pc+" ":""}${r.name}${s>1&&n?" over "+i.pc:""}`;return{...r,name:p,symbol:m,type:r.name,root:i.name,intervals:c,rootDegree:s,tonic:o.name,notes:l}}var So=g("Chord.chord","Chord.get",H);function No(t,e){let[n,r]=ut(t);return n?A(n,e)+r:t}function jo(t){let e=H(t),n=G(e.chroma);return U().filter(r=>n(r.chroma)).map(r=>r.name)}function Io(t){let e=H(t),n=G(e.chroma);return T().filter(r=>n(r.chroma)).map(r=>e.tonic+r.aliases[0])}function Co(t){let e=H(t),n=at(e.chroma);return T().filter(r=>n(r.chroma)).map(r=>e.tonic+r.aliases[0])}var Eo={getChord:ft,get:H,detect:Lt,chordScales:jo,extended:Io,reduced:Co,tokenize:ut,transpose:No,chord:So},Gt=Eo;var To=[[.125,"dl",["large","duplex longa","maxima","octuple","octuple whole"]],[.25,"l",["long","longa"]],[.5,"d",["double whole","double","breve"]],[1,"w",["whole","semibreve"]],[2,"h",["half","minim"]],[4,"q",["quarter","crotchet"]],[8,"e",["eighth","quaver"]],[16,"s",["sixteenth","semiquaver"]],[32,"t",["thirty-second","demisemiquaver"]],[64,"sf",["sixty-fourth","hemidemisemiquaver"]],[128,"h",["hundred twenty-eighth"]],[256,"th",["two hundred fifty-sixth"]]],Do=[];To.forEach(([t,e,n])=>Fo(t,e,n));function Fo(t,e,n){Do.push({empty:!1,dots:"",name:"",value:1/t,fraction:t<1?[1/t,1]:[1,t],shorthand:e,names:n})}var sa=w,aa="P m M m M P d P m M m M".split(" "),ca=L,la=we((t,e)=>[t[0]+e[0],t[1]+e[1]]),ma=we((t,e)=>[t[0]-e[0],t[1]-e[1]]);function we(t){return(e,n)=>{let r=w(e).coord,o=w(n).coord;if(r&&o){let i=t(r,o);return Ft(i).name}}}var pa=Math.log(2),da=Math.log(440),ha="C C# D D# E F F# G G# A A# B".split(" "),ya="C Db D Eb E F Gb G Ab A Bb B".split(" "),xa=d,va=A,Aa=A,Se={empty:!0,name:"",chordType:""},Ne={};function k(t){return typeof t=="string"?Ne[t]||(Ne[t]=$o(t)):typeof t=="number"?k(Ut[t]||""):nt(t)?Ro(t):et(t)?k(t.name):Se}var Sa=g("RomanNumeral.romanNumeral","RomanNumeral.get",k);function Ro(t){return k(rt(t.alt)+Ut[t.step])}var ko=/^(#{1,}|b{1,}|x{1,}|)(IV|I{1,3}|VI{0,2}|iv|i{1,3}|vi{0,2})([^IViv]*)$/;function Oo(t){return ko.exec(t)||["","","",""]}var je="I II III IV V VI VII",Ut=je.split(" "),Na=je.toLowerCase().split(" ");function $o(t){let[e,n,r,o]=Oo(t);if(!r)return Se;let i=r.toUpperCase(),a=Ut.indexOf(i),s=ot(n),c=1;return{empty:!1,name:e,roman:r,interval:w({step:a,alt:s,dir:c}).name,acc:n,chordType:o,alt:s,step:a,major:r===i,oct:0,dir:c}}var N=Object.freeze([]),Ie={type:"major",tonic:"",alteration:0,keySignature:""},pt={tonic:"",grades:N,intervals:N,scale:N,chords:N,chordsHarmonicFunction:N,chordScales:N},Da={...Ie,...pt,type:"major",minorRelative:"",scale:N,secondaryDominants:N,secondaryDominantsMinorRelative:N,substituteDominants:N,substituteDominantsMinorRelative:N},Fa={...Ie,type:"minor",relativeMajor:"",natural:pt,harmonic:pt,melodic:pt},Ce=(t,e,n="")=>e.map((r,o)=>`${t[o]}${n}${r}`);function dt(t,e,n,r){return o=>{let i=t.map(s=>k(s).interval||""),a=i.map(s=>A(o,s));return{tonic:o,grades:t,intervals:i,scale:a,chords:Ce(a,e),chordsHarmonicFunction:n.slice(),chordScales:Ce(a,r," ")}}}var Va=dt("I II III IV V VI VII".split(" "),"maj7 m7 m7 maj7 7 m7 m7b5".split(" "),"T SD T SD D T D".split(" "),"major,dorian,phrygian,lydian,mixolydian,minor,locrian".split(",")),Ra=dt("I II bIII IV V bVI bVII".split(" "),"m7 m7b5 maj7 m7 m7 maj7 7".split(" "),"T SD T SD D SD SD".split(" "),"minor,locrian,major,dorian,phrygian,lydian,mixolydian".split(",")),$a=dt("I II bIII IV V bVI VII".split(" "),"mMaj7 m7b5 +maj7 m7 7 maj7 o7".split(" "),"T SD T SD D SD D".split(" "),"harmonic minor,locrian 6,major augmented,lydian diminished,phrygian dominant,lydian #9,ultralocrian".split(",")),ka=dt("I II bIII IV V VI VII".split(" "),"m6 m7 +maj7 7 7 m7b5 m7b5".split(" "),"T SD T SD D  ".split(" "),"melodic minor,dorian b2,lydian augmented,lydian dominant,mixolydian b6,locrian #2,altered".split(","));var Ht=[[0,2773,0,"ionian","","Maj7","major"],[1,2902,2,"dorian","m","m7"],[2,3418,4,"phrygian","m","m7"],[3,2741,-1,"lydian","","Maj7"],[4,2774,1,"mixolydian","","7"],[5,2906,3,"aeolian","m","m7","minor"],[6,3434,5,"locrian","dim","m7b5"]],Ee={...C,name:"",alt:0,modeNum:NaN,triad:"",seventh:"",aliases:[]},Te=Ht.map(Lo),Kt={};Te.forEach(t=>{Kt[t.name]=t,t.aliases.forEach(e=>{Kt[e]=t})});function Xt(t){return typeof t=="string"?Kt[t.toLowerCase()]||Ee:t&&t.name?Xt(t.name):Ee}var Ha=g("Mode.mode","Mode.get",Xt);function qo(){return Te.slice()}var Ka=g("Mode.mode","Mode.all",qo);function Lo(t){let[e,n,r,o,i,a,s]=t,c=s?[s]:[],l=Number(n).toString(2),m=$t(l);return{empty:!1,intervals:m,modeNum:e,chroma:l,normalized:l,name:o,setNum:n,alt:r,triad:i,seventh:a,aliases:c}}function De(t){return(e,n)=>{let r=Xt(e);if(r.empty)return[];let o=q(r.modeNum,t),i=r.intervals.map(a=>A(n,a));return o.map((a,s)=>i[s]+a)}}var Xa=De(Ht.map(t=>t[4])),Qa=De(Ht.map(t=>t[5]));var Bo={empty:!0,name:"",type:"",tonic:null,setNum:NaN,chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function zo(t){if(typeof t!="string")return["",""];let e=t.indexOf(" "),n=d(t.substring(0,e));if(n.empty){let o=d(t);return o.empty?["",t]:[o.name,""]}let r=t.substring(n.name.length+1);return[n.name,r.length?r:""]}var fc=qt;function Go(t){let e=Array.isArray(t)?t:zo(t),n=d(e[0]).name,r=mt(e[1]);if(r.empty)return Bo;let o=r.name,i=n?r.intervals.map(s=>A(n,s)):[],a=n?n+" "+o:o;return{...r,name:a,type:o,tonic:n,notes:i}}var pc=g("Scale.scale","Scale.get",Go);var hc=new Map;var Wc=kt,Zc=Ot,Jc=Bt,ht="http://www.w3.org/1999/xhtml",Qt={svg:"http://www.w3.org/2000/svg",xhtml:ht,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function yt(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Qt.hasOwnProperty(e)?{space:Qt[e],local:t}:t}function Uo(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===ht&&e.documentElement.namespaceURI===ht?e.createElement(t):e.createElementNS(n,t)}}function Ho(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Pt(t){var e=yt(t);return(e.local?Ho:Uo)(e)}function Ko(){}function Mt(t){return t==null?Ko:function(){return this.querySelector(t)}}function Fe(t){typeof t!="function"&&(t=Mt(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i=e[o],a=i.length,s=r[o]=new Array(a),c,l,m=0;m<a;++m)(c=i[m])&&(l=t.call(c,c.__data__,m,i))&&("__data__"in c&&(l.__data__=c.__data__),s[m]=l);return new P(r,this._parents)}function Xo(){return[]}function Ve(t){return t==null?Xo:function(){return this.querySelectorAll(t)}}function Re(t){typeof t!="function"&&(t=Ve(t));for(var e=this._groups,n=e.length,r=[],o=[],i=0;i<n;++i)for(var a=e[i],s=a.length,c,l=0;l<s;++l)(c=a[l])&&(r.push(t.call(c,c.__data__,l,a)),o.push(c));return new P(r,o)}function $e(t){return function(){return this.matches(t)}}function ke(t){typeof t!="function"&&(t=$e(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i=e[o],a=i.length,s=r[o]=[],c,l=0;l<a;++l)(c=i[l])&&t.call(c,c.__data__,l,i)&&s.push(c);return new P(r,this._parents)}function _t(t){return new Array(t.length)}function Oe(){return new P(this._enter||this._groups.map(_t),this._parents)}function K(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}K.prototype={constructor:K,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Le(t){return function(){return t}}var qe="$";function Qo(t,e,n,r,o,i){for(var a=0,s,c=e.length,l=i.length;a<l;++a)(s=e[a])?(s.__data__=i[a],r[a]=s):n[a]=new K(t,i[a]);for(;a<c;++a)(s=e[a])&&(o[a]=s)}function Yo(t,e,n,r,o,i,a){var s,c,l={},m=e.length,p=i.length,f=new Array(m),u;for(s=0;s<m;++s)(c=e[s])&&(f[s]=u=qe+a.call(c,c.__data__,s,e),u in l?o[s]=c:l[u]=c);for(s=0;s<p;++s)u=qe+a.call(t,i[s],s,i),(c=l[u])?(r[s]=c,c.__data__=i[s],l[u]=null):n[s]=new K(t,i[s]);for(s=0;s<m;++s)(c=e[s])&&l[f[s]]===c&&(o[s]=c)}function Be(t,e){if(!t)return u=new Array(this.size()),l=-1,this.each(function(It){u[++l]=It}),u;var n=e?Yo:Qo,r=this._parents,o=this._groups;typeof t!="function"&&(t=Le(t));for(var i=o.length,a=new Array(i),s=new Array(i),c=new Array(i),l=0;l<i;++l){var m=r[l],p=o[l],f=p.length,u=t.call(m,m&&m.__data__,l,r),y=u.length,j=s[l]=new Array(y),E=a[l]=new Array(y),O=c[l]=new Array(f);n(m,p,j,E,O,u,e);for(var v=0,S=0,D,F;v<y;++v)if(D=j[v]){for(v>=S&&(S=v+1);!(F=E[S])&&++S<y;);D._next=F||null}}return a=new P(a,r),a._enter=s,a._exit=c,a}function ze(){return new P(this._exit||this._groups.map(_t),this._parents)}function Ge(t,e,n){var r=this.enter(),o=this,i=this.exit();return r=typeof t=="function"?t(r):r.append(t+""),e!=null&&(o=e(o)),n==null?i.remove():n(i),r&&o?r.merge(o).order():o}function Ue(t){for(var e=this._groups,n=t._groups,r=e.length,o=n.length,i=Math.min(r,o),a=new Array(r),s=0;s<i;++s)for(var c=e[s],l=n[s],m=c.length,p=a[s]=new Array(m),f,u=0;u<m;++u)(f=c[u]||l[u])&&(p[u]=f);for(;s<r;++s)a[s]=e[s];return new P(a,this._parents)}function He(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],o=r.length-1,i=r[o],a;--o>=0;)(a=r[o])&&(i&&a.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(a,i),i=a);return this}function Ke(t){t||(t=Wo);function e(p,f){return p&&f?t(p.__data__,f.__data__):!p-!f}for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var a=n[i],s=a.length,c=o[i]=new Array(s),l,m=0;m<s;++m)(l=a[m])&&(c[m]=l);c.sort(e)}return new P(o,this._parents).order()}function Wo(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Xe(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Qe(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t}function Ye(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],o=0,i=r.length;o<i;++o){var a=r[o];if(a)return a}return null}function We(){var t=0;return this.each(function(){++t}),t}function Ze(){return!this.node()}function Je(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var o=e[n],i=0,a=o.length,s;i<a;++i)(s=o[i])&&t.call(s,s.__data__,i,o);return this}function Zo(t){return function(){this.removeAttribute(t)}}function Jo(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ti(t,e){return function(){this.setAttribute(t,e)}}function ei(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function ni(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function ri(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function tn(t,e){var n=yt(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Jo:Zo:typeof e=="function"?n.local?ri:ni:n.local?ei:ti)(n,e))}function gt(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function oi(t){return function(){this.style.removeProperty(t)}}function ii(t,e,n){return function(){this.style.setProperty(t,e,n)}}function si(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function en(t,e,n){return arguments.length>1?this.each((e==null?oi:typeof e=="function"?si:ii)(t,e,n??"")):ai(this.node(),t)}function ai(t,e){return t.style.getPropertyValue(e)||gt(t).getComputedStyle(t,null).getPropertyValue(e)}function ci(t){return function(){delete this[t]}}function li(t,e){return function(){this[t]=e}}function mi(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function nn(t,e){return arguments.length>1?this.each((e==null?ci:typeof e=="function"?mi:li)(t,e)):this.node()[t]}function rn(t){return t.trim().split(/^|\s+/)}function Yt(t){return t.classList||new on(t)}function on(t){this._node=t,this._names=rn(t.getAttribute("class")||"")}on.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function sn(t,e){for(var n=Yt(t),r=-1,o=e.length;++r<o;)n.add(e[r])}function an(t,e){for(var n=Yt(t),r=-1,o=e.length;++r<o;)n.remove(e[r])}function ui(t){return function(){sn(this,t)}}function fi(t){return function(){an(this,t)}}function pi(t,e){return function(){(e.apply(this,arguments)?sn:an)(this,t)}}function cn(t,e){var n=rn(t+"");if(arguments.length<2){for(var r=Yt(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof e=="function"?pi:e?ui:fi)(n,e))}function di(){this.textContent=""}function hi(t){return function(){this.textContent=t}}function yi(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function ln(t){return arguments.length?this.each(t==null?di:(typeof t=="function"?yi:hi)(t)):this.node().textContent}function Pi(){this.innerHTML=""}function Mi(t){return function(){this.innerHTML=t}}function _i(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function mn(t){return arguments.length?this.each(t==null?Pi:(typeof t=="function"?_i:Mi)(t)):this.node().innerHTML}function gi(){this.nextSibling&&this.parentNode.appendChild(this)}function un(){return this.each(gi)}function xi(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function fn(){return this.each(xi)}function pn(t){var e=typeof t=="function"?t:Pt(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function vi(){return null}function dn(t,e){var n=typeof t=="function"?t:Pt(t),r=e==null?vi:typeof e=="function"?e:Mt(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Ai(){var t=this.parentNode;t&&t.removeChild(this)}function hn(){return this.each(Ai)}function bi(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function wi(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function yn(t){return this.select(t?wi:bi)}function Pn(t){return arguments.length?this.property("__data__",t):this.node().__data__}var Mn={},Wt=null;if(typeof document!="undefined"){var Si=document.documentElement;"onmouseenter"in Si||(Mn={mouseenter:"mouseover",mouseleave:"mouseout"})}function Ni(t,e,n){return t=_n(t,e,n),function(r){var o=r.relatedTarget;(!o||o!==this&&!(o.compareDocumentPosition(this)&8))&&t.call(this,r)}}function _n(t,e,n){return function(r){var o=Wt;Wt=r;try{t.call(this,this.__data__,e,n)}finally{Wt=o}}}function ji(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Ii(t){return function(){var e=this.__on;if(!e)return;for(var n=0,r=-1,o=e.length,i;n<o;++n)(i=e[n],(!t.type||i.type===t.type)&&i.name===t.name)?this.removeEventListener(i.type,i.listener,i.capture):e[++r]=i;++r?e.length=r:delete this.__on}}function Ci(t,e,n){var r=Mn.hasOwnProperty(t.type)?Ni:_n;return function(o,i,a){var s=this.__on,c,l=r(e,i,a);if(s){for(var m=0,p=s.length;m<p;++m)if((c=s[m]).type===t.type&&c.name===t.name){this.removeEventListener(c.type,c.listener,c.capture),this.addEventListener(c.type,c.listener=l,c.capture=n),c.value=e;return}}this.addEventListener(t.type,l,n),c={type:t.type,name:t.name,value:e,listener:l,capture:n},s?s.push(c):this.__on=[c]}}function gn(t,e,n){var r=ji(t+""),o,i=r.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var c=0,l=s.length,m;c<l;++c)for(o=0,m=s[c];o<i;++o)if((a=r[o]).type===m.type&&a.name===m.name)return m.value}return}for(s=e?Ci:Ii,n==null&&(n=!1),o=0;o<i;++o)this.each(s(r[o],e,n));return this}function xn(t,e,n){var r=gt(t),o=r.CustomEvent;typeof o=="function"?o=new o(e,n):(o=r.document.createEvent("Event"),n?(o.initEvent(e,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(e,!1,!1)),t.dispatchEvent(o)}function Ei(t,e){return function(){return xn(this,t,e)}}function Ti(t,e){return function(){return xn(this,t,e.apply(this,arguments))}}function vn(t,e){return this.each((typeof e=="function"?Ti:Ei)(t,e))}var Zt=[null];function P(t,e){this._groups=t,this._parents=e}function Di(){return new P([[document.documentElement]],Zt)}P.prototype=Di.prototype={constructor:P,select:Fe,selectAll:Re,filter:ke,data:Be,enter:Oe,exit:ze,join:Ge,merge:Ue,order:He,sort:Ke,call:Xe,nodes:Qe,node:Ye,size:We,empty:Ze,each:Je,attr:tn,style:en,property:nn,classed:cn,text:ln,html:mn,raise:un,lower:fn,append:pn,insert:dn,remove:hn,clone:yn,datum:Pn,on:gn,dispatch:vn};function An(t){return typeof t=="string"?new P([[document.querySelector(t)]],[document.documentElement]):new P([[t]],Zt)}var xt=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],bn={A:"G##","A#":"Bb",Ab:"G#",B:"Cb","B#":"C",Bb:"A#",C:"B#","C#":"Db",D:"C##","D#":"Eb",Db:"C#","E#":"F",Eb:"D#",F:"E#","F#":"Gb",G:"F##","G#":"Ab",Gb:"F#"},_=["#fb8072","#fccde5","#fdb462","#ffed6f","#ffffb3","#b3de69","#ccebc5","#80b1d3","#bc80bd","#8dd3c7","#bebada","#d9d9d9"];function wn(t,e,n=[]){let r=(t+e)%xt.length,o=xt[r];if(n&&!n.includes(o)){let i=bn[o];if(n.includes(i))o=i;else return}return o}function Jt(t){switch(t.length){case 3:return[_[0],_[4],_[7]];case 4:return[_[0],_[4],_[7],_[11]];case 5:return[_[0],_[4],_[7],_[11],_[2]];case 7:return[_[0],_[2],_[4],_[5],_[7],_[9],_[11]];default:return _.slice(0,t.length)}}function Sn(t){return t.endsWith("b")?xt.indexOf(bn[t]):xt.indexOf(t)}function Nn(t){return t.replace(/b/g,"\u266D").replace(/#/g,"\u266F")}function te(t,e,n,r,o="#cccccc",i=null,a=null,s=null){let c=t.append("svg:circle").attr("cx",e).attr("cy",n).attr("r",r).style("fill",o);i&&c.style("stroke",i),a&&c.style("stroke-width",a),s&&c.attr("title",s)}function ee(t,e,n){let r=e.tuning,o=e.string_gauges,i=e.fret_count,a=An(t);a.selectAll("*").remove();let s=a.node().parentElement.getBoundingClientRect(),c=s.width*.95,l=40,m=140,p=l*(i+1),f=m*(i+1);c=Math.min(f,Math.max(p,c));let u=c/(i+1),y=u*.65,j=y*.1,E=u*.01,O=u*.8,v=y*.5,S=y*r.length+v,D=c-O*1.2,F=[3,5,7,9,12,15,17,19,21,24],It=y*(r.length-1),Mr=u*.06,Y=u*.22,_r=Y*.2,W=Y*1.05,Z=Y*.3;a.attr("width",c).attr("height",S);let J=`translate(${O}, ${v})`,gr=a.append("g").attr("class","frets").attr("transform",J),ie=a.append("g").attr("class","fret-markers").attr("transform",J),xr=a.append("g").attr("class","strings").attr("transform",J),se=a.append("g").attr("class","notes").attr("transform",J);for(let M=0;M<=i;M++){let I=M*u,b=Mr;M==0&&(b*=1.5),gr.append("svg:line").attr("x1",I).attr("y1",-j/2).attr("x2",I).attr("y2",It+j).style("stroke","#222222").style("stroke-width",b).append("title").text(M)}for(let M of F){if(M>i)break;let I=M*u-u/2,b=S-v-Z*3;if(M%12==0){let V=Z*1.3;te(ie,I+V,b,Z),I-=V}te(ie,I,b,Z)}for(let M=0;M<r.length;M++){let I=r[M],b=M*y;xr.append("svg:line").attr("x1",-E/2).attr("y1",b).attr("x2",D+E).attr("y2",b).style("stroke","#444444").style("stroke-width",o[M]*y).append("title").text(I)}for(let M=0;M<r.length;M++){let I=Sn(r[M]);for(let b=0;b<=i;b++){let V=wn(I,b,n);if(!V)continue;let Ct=b*u-u*.5,ae=M*y,ce=Ct-W*.34,vr=ae+W*.34;V.length>1&&(ce=Ct-W*.5),te(se,Ct,ae,Y,"#ffffff","#aaaaaa",_r,V),se.append("svg:text").attr("x",ce).attr("y",vr).attr("fill","#000000").style("font-size",`${W}px`).text(Nn(V))}}}var ne={guitar:{tuning:["E","B","G","D","A","E"],string_gauges:[.01,.013,.017,.026,.036,.046],fret_count:15},ukulele:{tuning:["A","E","C","G"],string_gauges:[.024,.031,.037,.026],fret_count:12}};var vt="http://www.w3.org/1999/xhtml",re={svg:"http://www.w3.org/2000/svg",xhtml:vt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function At(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),re.hasOwnProperty(e)?{space:re[e],local:t}:t}function Fi(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===vt&&e.documentElement.namespaceURI===vt?e.createElement(t):e.createElementNS(n,t)}}function Vi(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function bt(t){var e=At(t);return(e.local?Vi:Fi)(e)}function Ri(){}function wt(t){return t==null?Ri:function(){return this.querySelector(t)}}function jn(t){typeof t!="function"&&(t=wt(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i=e[o],a=i.length,s=r[o]=new Array(a),c,l,m=0;m<a;++m)(c=i[m])&&(l=t.call(c,c.__data__,m,i))&&("__data__"in c&&(l.__data__=c.__data__),s[m]=l);return new h(r,this._parents)}function z(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function $i(){return[]}function In(t){return t==null?$i:function(){return this.querySelectorAll(t)}}function ki(t){return function(){var e=t.apply(this,arguments);return e==null?[]:z(e)}}function Cn(t){typeof t=="function"?t=ki(t):t=In(t);for(var e=this._groups,n=e.length,r=[],o=[],i=0;i<n;++i)for(var a=e[i],s=a.length,c,l=0;l<s;++l)(c=a[l])&&(r.push(t.call(c,c.__data__,l,a)),o.push(c));return new h(r,o)}function En(t){return function(){return this.matches(t)}}function St(t){return function(e){return e.matches(t)}}var Oi=Array.prototype.find;function Li(t){return function(){return Oi.call(this.children,t)}}function qi(){return this.firstElementChild}function Tn(t){return this.select(t==null?qi:Li(typeof t=="function"?t:St(t)))}var Bi=Array.prototype.filter;function zi(){return this.children}function Gi(t){return function(){return Bi.call(this.children,t)}}function Dn(t){return this.selectAll(t==null?zi:Gi(typeof t=="function"?t:St(t)))}function Fn(t){typeof t!="function"&&(t=En(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i=e[o],a=i.length,s=r[o]=[],c,l=0;l<a;++l)(c=i[l])&&t.call(c,c.__data__,l,i)&&s.push(c);return new h(r,this._parents)}function Nt(t){return new Array(t.length)}function Vn(){return new h(this._enter||this._groups.map(Nt),this._parents)}function X(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}X.prototype={constructor:X,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Rn(t){return function(){return t}}function Ui(t,e,n,r,o,i){for(var a=0,s,c=e.length,l=i.length;a<l;++a)(s=e[a])?(s.__data__=i[a],r[a]=s):n[a]=new X(t,i[a]);for(;a<c;++a)(s=e[a])&&(o[a]=s)}function Hi(t,e,n,r,o,i,a){var s,c,l=new Map,m=e.length,p=i.length,f=new Array(m),u;for(s=0;s<m;++s)(c=e[s])&&(f[s]=u=a.call(c,c.__data__,s,e)+"",l.has(u)?o[s]=c:l.set(u,c));for(s=0;s<p;++s)u=a.call(t,i[s],s,i)+"",(c=l.get(u))?(r[s]=c,c.__data__=i[s],l.delete(u)):n[s]=new X(t,i[s]);for(s=0;s<m;++s)(c=e[s])&&l.get(f[s])===c&&(o[s]=c)}function Ki(t){return t.__data__}function $n(t,e){if(!arguments.length)return Array.from(this,Ki);var n=e?Hi:Ui,r=this._parents,o=this._groups;typeof t!="function"&&(t=Rn(t));for(var i=o.length,a=new Array(i),s=new Array(i),c=new Array(i),l=0;l<i;++l){var m=r[l],p=o[l],f=p.length,u=z(t.call(m,m&&m.__data__,l,r)),y=u.length,j=s[l]=new Array(y),E=a[l]=new Array(y),O=c[l]=new Array(f);n(m,p,j,E,O,u,e);for(var v=0,S=0,D,F;v<y;++v)if(D=j[v]){for(v>=S&&(S=v+1);!(F=E[S])&&++S<y;);D._next=F||null}}return a=new h(a,r),a._enter=s,a._exit=c,a}function kn(){return new h(this._exit||this._groups.map(Nt),this._parents)}function On(t,e,n){var r=this.enter(),o=this,i=this.exit();return r=typeof t=="function"?t(r):r.append(t+""),e!=null&&(o=e(o)),n==null?i.remove():n(i),r&&o?r.merge(o).order():o}function Ln(t){if(!(t instanceof h))throw new Error("invalid merge");for(var e=this._groups,n=t._groups,r=e.length,o=n.length,i=Math.min(r,o),a=new Array(r),s=0;s<i;++s)for(var c=e[s],l=n[s],m=c.length,p=a[s]=new Array(m),f,u=0;u<m;++u)(f=c[u]||l[u])&&(p[u]=f);for(;s<r;++s)a[s]=e[s];return new h(a,this._parents)}function qn(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],o=r.length-1,i=r[o],a;--o>=0;)(a=r[o])&&(i&&a.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(a,i),i=a);return this}function Bn(t){t||(t=Xi);function e(p,f){return p&&f?t(p.__data__,f.__data__):!p-!f}for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var a=n[i],s=a.length,c=o[i]=new Array(s),l,m=0;m<s;++m)(l=a[m])&&(c[m]=l);c.sort(e)}return new h(o,this._parents).order()}function Xi(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function zn(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Gn(){return Array.from(this)}function Un(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],o=0,i=r.length;o<i;++o){var a=r[o];if(a)return a}return null}function Hn(){let t=0;for(let e of this)++t;return t}function Kn(){return!this.node()}function Xn(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var o=e[n],i=0,a=o.length,s;i<a;++i)(s=o[i])&&t.call(s,s.__data__,i,o);return this}function Qi(t){return function(){this.removeAttribute(t)}}function Yi(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Wi(t,e){return function(){this.setAttribute(t,e)}}function Zi(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Ji(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function ts(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Qn(t,e){var n=At(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Yi:Qi:typeof e=="function"?n.local?ts:Ji:n.local?Zi:Wi)(n,e))}function jt(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function es(t){return function(){this.style.removeProperty(t)}}function ns(t,e,n){return function(){this.style.setProperty(t,e,n)}}function rs(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Yn(t,e,n){return arguments.length>1?this.each((e==null?es:typeof e=="function"?rs:ns)(t,e,n??"")):os(this.node(),t)}function os(t,e){return t.style.getPropertyValue(e)||jt(t).getComputedStyle(t,null).getPropertyValue(e)}function is(t){return function(){delete this[t]}}function ss(t,e){return function(){this[t]=e}}function as(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Wn(t,e){return arguments.length>1?this.each((e==null?is:typeof e=="function"?as:ss)(t,e)):this.node()[t]}function Zn(t){return t.trim().split(/^|\s+/)}function oe(t){return t.classList||new Jn(t)}function Jn(t){this._node=t,this._names=Zn(t.getAttribute("class")||"")}Jn.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function tr(t,e){for(var n=oe(t),r=-1,o=e.length;++r<o;)n.add(e[r])}function er(t,e){for(var n=oe(t),r=-1,o=e.length;++r<o;)n.remove(e[r])}function cs(t){return function(){tr(this,t)}}function ls(t){return function(){er(this,t)}}function ms(t,e){return function(){(e.apply(this,arguments)?tr:er)(this,t)}}function nr(t,e){var n=Zn(t+"");if(arguments.length<2){for(var r=oe(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof e=="function"?ms:e?cs:ls)(n,e))}function us(){this.textContent=""}function fs(t){return function(){this.textContent=t}}function ps(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function rr(t){return arguments.length?this.each(t==null?us:(typeof t=="function"?ps:fs)(t)):this.node().textContent}function ds(){this.innerHTML=""}function hs(t){return function(){this.innerHTML=t}}function ys(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function or(t){return arguments.length?this.each(t==null?ds:(typeof t=="function"?ys:hs)(t)):this.node().innerHTML}function Ps(){this.nextSibling&&this.parentNode.appendChild(this)}function ir(){return this.each(Ps)}function Ms(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function sr(){return this.each(Ms)}function ar(t){var e=typeof t=="function"?t:bt(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function _s(){return null}function cr(t,e){var n=typeof t=="function"?t:bt(t),r=e==null?_s:typeof e=="function"?e:wt(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function gs(){var t=this.parentNode;t&&t.removeChild(this)}function lr(){return this.each(gs)}function xs(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function vs(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function mr(t){return this.select(t?vs:xs)}function ur(t){return arguments.length?this.property("__data__",t):this.node().__data__}function As(t){return function(e){t.call(this,e,this.__data__)}}function bs(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function ws(t){return function(){var e=this.__on;if(!e)return;for(var n=0,r=-1,o=e.length,i;n<o;++n)(i=e[n],(!t.type||i.type===t.type)&&i.name===t.name)?this.removeEventListener(i.type,i.listener,i.options):e[++r]=i;++r?e.length=r:delete this.__on}}function Ss(t,e,n){return function(){var r=this.__on,o,i=As(e);if(r){for(var a=0,s=r.length;a<s;++a)if((o=r[a]).type===t.type&&o.name===t.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=n),o.value=e;return}}this.addEventListener(t.type,i,n),o={type:t.type,name:t.name,value:e,listener:i,options:n},r?r.push(o):this.__on=[o]}}function fr(t,e,n){var r=bs(t+""),o,i=r.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var c=0,l=s.length,m;c<l;++c)for(o=0,m=s[c];o<i;++o)if((a=r[o]).type===m.type&&a.name===m.name)return m.value}return}for(s=e?Ss:ws,o=0;o<i;++o)this.each(s(r[o],e,n));return this}function pr(t,e,n){var r=jt(t),o=r.CustomEvent;typeof o=="function"?o=new o(e,n):(o=r.document.createEvent("Event"),n?(o.initEvent(e,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(e,!1,!1)),t.dispatchEvent(o)}function Ns(t,e){return function(){return pr(this,t,e)}}function js(t,e){return function(){return pr(this,t,e.apply(this,arguments))}}function dr(t,e){return this.each((typeof e=="function"?js:Ns)(t,e))}function*hr(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],o=0,i=r.length,a;o<i;++o)(a=r[o])&&(yield a)}var Q=[null];function h(t,e){this._groups=t,this._parents=e}function Is(){return new h([[document.documentElement]],Q)}function Cs(){return this}h.prototype=Is.prototype={constructor:h,select:jn,selectAll:Cn,selectChild:Tn,selectChildren:Dn,filter:Fn,data:$n,enter:Vn,exit:kn,join:On,merge:Ln,selection:Cs,order:qn,sort:Bn,call:zn,nodes:Gn,node:Un,size:Hn,empty:Kn,each:Xn,attr:Qn,style:Yn,property:Wn,classed:nr,text:rr,html:or,raise:ir,lower:sr,append:ar,insert:cr,remove:lr,clone:mr,datum:ur,on:fr,dispatch:dr,[Symbol.iterator]:hr};function yr(t){return typeof t=="string"?new h([[document.querySelector(t)]],[document.documentElement]):new h([[t]],Q)}function Pr(t){return typeof t=="string"?new h([document.querySelectorAll(t)],[document.documentElement]):new h([t==null?[]:z(t)],Q)}function Es(t,e){ee("#fretboard",ne.ukulele,t.notes);for(let n in t.notes)Pr(`#fretboard .notes circle[title="${t.notes[n]}"]`).style("fill",e[n])}var Ts=yr("#chord-name").on("change",t=>{let e=Gt.get(t.target.value),n=Jt(e.notes);Es(e,n)});Ts.attr("value","C").dispatch("change");})();
