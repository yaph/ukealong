// https://github.com/yaph/traste v0.1.0 Copyright 2019 Ramiro Gómez
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3-selection")):"function"==typeof define&&define.amd?define(["exports","d3-selection"],e):e((t=t||self).traste={},t.d3)}(this,(function(t,e){"use strict";let r=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],n={A:"G##","A#":"Bb",Ab:"G#",B:"Cb","B#":"C",Bb:"A#",C:"B#","C#":"Db",D:"C##","D#":"Eb",Db:"C#","E#":"F",Eb:"D#",F:"E#","F#":"Gb",G:"F##","G#":"Ab",Gb:"F#"};function l(t,e,l=[]){let a=(t+e)%r.length,s=r[a];if(l&&!l.includes(s)){let t=n[s];if(!l.includes(t))return;s=t}return s}function a(t){return t.replace(/b/g,"♭").replace(/#/g,"♯")}function s(t,e,r,n,l="#cccccc",a=null,s=null,i=null){let f=t.append("svg:circle").attr("cx",e).attr("cy",r).attr("r",n).style("fill",l);a&&f.style("stroke",a),s&&f.style("stroke-width",s),i&&f.attr("title",i)}t.drawFretboard=function(t,i,f){let o=i.tuning,c=i.string_gauges,d=i.fret_count,u=e.select(t);u.selectAll("*").remove();let g=.95*u.node().parentElement.getBoundingClientRect().width,p=40*(d+1),y=140*(d+1);g=Math.min(y,Math.max(p,g));let b=g/(d+1),h=.65*b,x=.1*h,m=.01*b,A=.8*b,C=.5*h,G=h*o.length+C,k=g-1.2*A,E=[3,5,7,9,12,15,17,19,21,24],B=h*(o.length-1),D=.06*b,F=.22*b,_=.2*F,v=1.05*F,w=.3*F;u.attr("width",g).attr("height",G);let M=`translate(${A}, ${C})`,O=u.append("g").attr("class","frets").attr("transform",M),$=u.append("g").attr("class","fret-markers").attr("transform",M),j=u.append("g").attr("class","strings").attr("transform",M),q=u.append("g").attr("class","notes").attr("transform",M);for(let t=0;t<=d;t++){let e=t*b,r=D;0==t&&(r*=1.5),O.append("svg:line").attr("x1",e).attr("y1",-x/2).attr("x2",e).attr("y2",B+x).style("stroke","#222222").style("stroke-width",r).append("title").text(t)}for(let t of E){if(t>d)break;let e=t*b-b/2,r=G-C-3*w;if(0==t%12){let t=1.3*w;s($,e+t,r,w),e-=t}s($,e,r,w)}for(let t=0;t<o.length;t++){let e=o[t],r=t*h;j.append("svg:line").attr("x1",-m/2).attr("y1",r).attr("x2",k+m).attr("y2",r).style("stroke","#444444").style("stroke-width",c[t]*h).append("title").text(e)}for(let t=0;t<o.length;t++){let e=(z=o[t]).endsWith("b")?r.indexOf(n[z]):r.indexOf(z);for(let r=0;r<=d;r++){let n=l(e,r,f);if(!n)continue;let i=r*b-.5*b,o=t*h,c=i-.34*v,d=o+.34*v;n.length>1&&(c=i-.5*v),s(q,i,o,F,"#ffffff","#aaaaaa",_,n),q.append("svg:text").attr("x",c).attr("y",d).attr("fill","#000000").style("font-size",`${v}px`).text(a(n))}}var z},t.instruments={guitar:{tuning:["E","B","G","D","A","E"],string_gauges:[.01,.013,.017,.026,.036,.046],fret_count:15},ukulele:{tuning:["A","E","C","G"],string_gauges:[.024,.031,.037,.026],fret_count:12}},Object.defineProperty(t,"__esModule",{value:!0})}));
