// https://github.com/yaph/traste v0.1.0 Copyright 2019 Ramiro Gómez
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3-selection")):"function"==typeof define&&define.amd?define(["exports","d3-selection"],e):e((t=t||self).traste={},t.d3)}(this,(function(t,e){"use strict";let r=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],n={A:"G##","A#":"Bb",Ab:"G#",B:"Cb","B#":"C",Bb:"A#",C:"B#","C#":"Db",D:"C##","D#":"Eb",Db:"C#","E#":"F",Eb:"D#",F:"E#","F#":"Gb",G:"F##","G#":"Ab",Gb:"F#"},l=["#fb8072","#fccde5","#fdb462","#ffed6f","#ffffb3","#b3de69","#ccebc5","#80b1d3","#bc80bd","#8dd3c7","#bebada","#d9d9d9"];function a(t,e,l=[]){let a=(t+e)%r.length,s=r[a];if(l&&!l.includes(s)){let t=n[s];if(!l.includes(t))return;s=t}return s}function s(t){return t.replace(/b/g,"♭").replace(/#/g,"♯")}function f(t,e,r,n,l="#cccccc",a=null,s=null,f=null){let i=t.append("svg:circle").attr("cx",e).attr("cy",r).attr("r",n).style("fill",l);a&&i.style("stroke",a),s&&i.style("stroke-width",s),f&&i.attr("title",f)}t.drawFretboard=function(t,l,i){let c=l.tuning,d=l.string_gauges,o=l.fret_count,u=e.select(t);u.selectAll("*").remove();let g=.95*u.node().parentElement.getBoundingClientRect().width,p=40*(o+1),b=140*(o+1);g=Math.min(b,Math.max(p,g));let h=g/(o+1),y=.65*h,x=.1*y,m=.01*h,C=.8*h,A=.5*y,G=y*c.length+A,k=g-1.2*C,E=[3,5,7,9,12,15,17,19,21,24],B=y*(c.length-1),D=.06*h,F=.22*h,_=.2*F,v=1.05*F,w=.3*F;u.attr("width",g).attr("height",G);let M=`translate(${C}, ${A})`,O=u.append("g").attr("class","frets").attr("transform",M),$=u.append("g").attr("class","fret-markers").attr("transform",M),j=u.append("g").attr("class","strings").attr("transform",M),q=u.append("g").attr("class","notes").attr("transform",M);for(let t=0;t<=o;t++){let e=t*h,r=D;0==t&&(r*=1.5),O.append("svg:line").attr("x1",e).attr("y1",-x/2).attr("x2",e).attr("y2",B+x).style("stroke","#222222").style("stroke-width",r).append("title").text(t)}for(let t of E){if(t>o)break;let e=t*h-h/2,r=G-A-3*w;if(0==t%12){let t=1.3*w;f($,e+t,r,w),e-=t}f($,e,r,w)}for(let t=0;t<c.length;t++){let e=c[t],r=t*y;j.append("svg:line").attr("x1",-m/2).attr("y1",r).attr("x2",k+m).attr("y2",r).style("stroke","#444444").style("stroke-width",d[t]*y).append("title").text(e)}for(let t=0;t<c.length;t++){let e=(z=c[t]).endsWith("b")?r.indexOf(n[z]):r.indexOf(z);for(let r=0;r<=o;r++){let n=a(e,r,i);if(!n)continue;let l=r*h-.5*h,c=t*y,d=l-.34*v,o=c+.34*v;n.length>1&&(d=l-.5*v),f(q,l,c,F,"#ffffff","#aaaaaa",_,n),q.append("svg:text").attr("x",d).attr("y",o).attr("fill","#000000").style("font-size",`${v}px`).text(s(n))}}var z},t.instruments={guitar:{tuning:["E","B","G","D","A","E"],string_gauges:[.01,.013,.017,.026,.036,.046],fret_count:15},ukulele:{tuning:["A","E","C","G"],string_gauges:[.024,.031,.037,.026],fret_count:12}},t.noteColors=function(t){switch(t.length){case 3:return[l[0],l[4],l[7]];case 4:return[l[0],l[4],l[7],l[11]];case 5:return[l[0],l[4],l[7],l[11],l[2]];case 7:return[l[0],l[2],l[4],l[5],l[7],l[9],l[11]];default:return l.slice(0,t.length)}},Object.defineProperty(t,"__esModule",{value:!0})}));
